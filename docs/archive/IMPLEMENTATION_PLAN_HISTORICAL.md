## Implementation Status Overview

> **Documentation Update Notice (2025-08-20)**
> This file has been restructured for better organization. Related documentation:
> - `docs/ARCHITECTURE_OVERVIEW.md` - System architecture and design principles
> - `docs/AUDIO_SYSTEM.md` - Detailed audio system documentation
> - `docs/VISUALIZATION_SYSTEM.md` - Visualization system documentation
> - `docs/DEVELOPMENT_ROADMAP.md` - Future development plans
> - `docs/NEXT_TASKS_TEST_SIGNAL_AND_BASE_AUDIO.md` - Historical Phase 1-3 implementation logs

## âœ… Completed Implementation Summary
### ğŸ¯ Phase 1-3: Base Audio Architecture (âœ… Completed)
**Status**: âœ… **Fully Implemented**
**Completion Date**: 2025-08-17

#### Core Achievements
- âœ… **Base Audio Layer Separation**: DSP-independent audio functionality
- âœ… **TestSignalManager Integration**: Unified test signal system
- âœ… **RoutingUI Modernization**: Improved user interface integration
- âœ… **Backward Compatibility**: Legacy code continues to function

#### Key Implementation Files
- `src/audio/audioCore.ts` - Two-stage initialization system
- `src/audio/testSignalManager.ts` - Unified test signal management
- `src/audio/routingUI.ts` - TestSignalManager API integration
- `src/controller.ts` - Enhanced UI controls

For detailed implementation logs, see: `docs/NEXT_TASKS_TEST_SIGNAL_AND_BASE_AUDIO.md`

### 2025-08-18 Phase 1: å®Ÿéš›ã®Faust WASMçµ±åˆ å®Œäº† âœ…
**æ¦‚è¦**: ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã®GainNodeã‹ã‚‰å®Ÿéš›ã®Faust AudioWorkletNodeã¸ã®ç§»è¡Œå®Œäº†ã€‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡ã®å®Ÿè£…ã€‚

#### **Phase 1: FaustWasmLoader æ ¸å¿ƒå®Ÿè£…**
- **æ–°ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/dsp/faustWasmLoader.ts` (212è¡Œ)
- **æ ¸å¿ƒæ©Ÿèƒ½**:
  - `@grame/faustwasm`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆã«ã‚ˆã‚‹å®Ÿéš›ã®DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
  - DSPã‚³ãƒ¼ãƒ‰ â†’ AudioWorkletNodeå¤‰æ›ã®å®Œå…¨è‡ªå‹•åŒ–
  - LibFaust + FaustCompiler + FaustMonoDspGeneratoré€£æºå®Ÿè£…
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æƒ…å ±è‡ªå‹•æŠ½å‡ºã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹
- **æŠ€è¡“è©³ç´°**:
  - ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
  - FaustWasmåˆæœŸåŒ–ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç†
  - DSPãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒ¼ãƒ‰ãƒ»è§£æãƒ»AudioWorkletNodeç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆtype, label, address, rangeï¼‰

#### **Phase 2: EffectRegistry v2 å®Ÿè£…**
- **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/effects/effectRegistry.ts`
- **é‡è¦ãªå¤‰æ›´**:
  - ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼GainNode â†’ å®Ÿéš›ã®Faust AudioWorkletNodeç”Ÿæˆ
  - `registerDSPFromFile()` / `registerPrecompiledFaust()` ã® create() ãƒ¡ã‚½ãƒƒãƒ‰åˆ·æ–°
  - FaustWasmLoaderã¨FaustEffectControllerçµ±åˆ
  - DSPè‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½ï¼ˆmysynth, testsignals, testsynthå¯¾å¿œï¼‰
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•è¨­è¨ˆ**:
  - .jsonãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹DSPåˆ†é¡ï¼ˆsource, effect, hybrid, utilityï¼‰
  - äº’æ›æ€§æƒ…å ±ç®¡ç†ï¼ˆcanBeSource, requiresInput, etc.ï¼‰
  - ã‚«ãƒ†ã‚´ãƒªã¨ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã«ã‚ˆã‚‹ä½“ç³»çš„åˆ†é¡

#### **Phase 3: åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ç¾¤**
- **æ–°ãƒ•ã‚¡ã‚¤ãƒ«**: `src/phase1TestFunctions.ts` (251è¡Œ)
- **ãƒ†ã‚¹ãƒˆé–¢æ•°**:
  - `testFaustWasmIntegration()`: FaustWasmLoaderå˜ä½“ãƒ†ã‚¹ãƒˆ
  - `testEffectRegistryV2()`: EffectRegistry v2çµ±åˆãƒ†ã‚¹ãƒˆ
  - `testMysynthCreation()`: mysynthéŸ³å£°æ¥ç¶šãƒ†ã‚¹ãƒˆ
  - `testSimpleSynth()`: å…¥åŠ›ä¸è¦testsynthãƒ†ã‚¹ãƒˆ
  - `showRegisteredEffects()`: ç™»éŒ²ã‚¨ãƒ•ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤º
- **ãƒ‡ãƒãƒƒã‚°æ”¯æ´**:
  - è©³ç´°ãªå®Ÿè¡Œãƒ­ã‚°ã¨ã‚¨ãƒ©ãƒ¼æƒ…å ±
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡ã®å‹•ä½œç¢ºèª
  - éŸ³å£°å‡ºåŠ›ã®å®Ÿéš›ã®ç¢ºèª

#### **Phase 4: ãƒ†ã‚¹ãƒˆç”¨DSPä½œæˆ**
- **testsynth.dsp**: å…¥åŠ›ä¸è¦ã®ã‚·ãƒ³ãƒ—ãƒ«ãªã‚µã‚¦ã‚¹ã‚¦ã‚§ãƒ¼ãƒ–ã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼
  ```faust
  freq = hslider("freq",440,50,1000,0.01);
  gain = hslider("gain",0.1,0,0.5,0.01);
  process = os.sawtooth(freq) * gain;
  ```
- **testsynth.json**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼ˆsource/test-synthåˆ†é¡ï¼‰
- **mysynth.json**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹ä¿®æ­£ï¼ˆ`/freq` â†’ `/mysynth/freq`ï¼‰

#### **æŠ€è¡“çš„æˆæœã¨æ¤œè¨¼**
- **å®Ÿéš›ã®éŸ³å£°å‡ºåŠ›ç¢ºèª**: âœ… 440Hz ã‚µã‚¦ã‚¹ã‚¦ã‚§ãƒ¼ãƒ–ã®å®Ÿéš›ã®éŸ³å£°å‡ºåŠ›
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡å‹•ä½œ**: âœ… freq/gainãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ¶å¾¡ã®ç¢ºèª
- **DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æˆåŠŸ**: âœ… Faustã‚³ãƒ¼ãƒ‰ã‹ã‚‰AudioWorkletNodeã¸ã®å¤‰æ›
- **Effectç™»éŒ²çµ±åˆ**: âœ… 6ã¤ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆnative: 3, faust: 3ï¼‰æ­£å¸¸ç™»éŒ²
- **å…¥å‡ºåŠ›å¯¾å¿œ**: âœ… å…¥åŠ›ä¸è¦DSPï¼ˆtestsynthï¼‰ã¨å…¥åŠ›å¿…è¦DSPï¼ˆmysynthï¼‰ä¸¡å¯¾å¿œ

#### **æ¤œè¨¼æ¸ˆã¿ãƒ­ã‚°æŠœç²‹**
```
âœ… Faust node created: testsynth {inputs: 0, outputs: 1, params: 2}
ğŸ›ï¸ Set param freq (/testsynth/freq) = 440
ğŸ›ï¸ Set param gain (/testsynth/gain) = 0.1
ğŸ’¡ You should now hear a 440Hz sawtooth wave (no input required)
```

#### **å®Ÿè£…ã§ã®é‡è¦ãªå­¦ç¿’**
- **å…¥åŠ›è¦ä»¶ã®é•ã„**: mysynthï¼ˆå…¥åŠ›å‡¦ç†å‹ï¼‰vs testsynthï¼ˆå…¥åŠ›ä¸è¦å‹ï¼‰ã®è¨­è¨ˆå·®ç•°
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°**: Faustã®éšå±¤çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‘½åï¼ˆ`/dspname/param`ï¼‰ã®é‡è¦æ€§
- **AudioWorkletNodeçµ±åˆ**: Web Audio APIã¨FaustWASMã®å®Œå…¨çµ±åˆæ‰‹æ³•
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«**: ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ã®DSPã‚³ãƒ¼ãƒ‰ â†’ å®Ÿè¡Œå¯èƒ½éŸ³å£°ãƒãƒ¼ãƒ‰å¤‰æ›

### 2025-08-18 Faust DSP éŸ³éŸ¿å•é¡Œè§£æ±ºå®Œäº† âœ…
**æ¦‚è¦**: Base Audio åˆ†é›¢å¾Œã«DSPéŸ³å£°ãŒå‡ºåŠ›ã•ã‚Œãªã„å•é¡Œã¨éŸ³å£°ã®ä¸å®‰å®šæ€§å•é¡Œã‚’è§£æ±ºã€‚

#### **Phase 1: DSP éŸ³å£°å‡ºåŠ›å•é¡Œè¨ºæ–­ãƒ»è§£æ±º**
- **å•é¡ŒçŠ¶æ³**: ãƒ†ã‚¹ãƒˆä¿¡å·ã¯æ­£å¸¸å‹•ä½œã™ã‚‹ãŒFaust DSPéŸ³å£°ãŒç„¡éŸ³çŠ¶æ…‹
- **åŸå› ç‰¹å®š**: 
  - AudioContext suspendedçŠ¶æ…‹ã§ã®åˆæœŸåŒ–
  - Faust DSPãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã‚³ãƒ¼ãƒ‰å´åˆæœŸåŒ–ã®ç«¶åˆ
  - éŸ³å£°æ¥ç¶šã®ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- **æŠ€è¡“çš„è§£æ±ºç­–**:
  - AudioContextè‡ªå‹•resumeæ©Ÿèƒ½ã¨keep-aliveæ©Ÿæ§‹è¿½åŠ ï¼ˆ5ç§’é–“éš”ç›£è¦–ï¼‰
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç«¶åˆæ’é™¤ï¼šFaust DSPå´ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆfreq=200Hz, gain=0.5, input_mix=0.5ï¼‰ã‚’å°Šé‡
  - `window.audioConnections`ã«ã‚ˆã‚‹éŸ³å£°æ¥ç¶šå‚ç…§ä¿æŒã§ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é˜²æ­¢

#### **Phase 2: éŸ³å£°å®‰å®šæ€§æ”¹å–„**
- **å•é¡Œ**: æœŸå¾…é€šã‚Šã®éŸ³ãŒå‡ºã‚‹ãŒæ™‚é–“çµŒéã§éŸ³å£°ãŒæ¶ˆå¤±
- **å¯¾ç­–å®Ÿè£…**:
  - AudioContext keep-aliveæ©Ÿæ§‹ã«ã‚ˆã‚‹è‡ªå‹•suspensioné˜²æ­¢
  - éŸ³å£°ãƒãƒ¼ãƒ‰æ¥ç¶šã®ç¢ºå®Ÿãªå‚ç…§ä¿æŒ
  - MicRouteræœªæ¥ç¶šæ™‚ã®silent inputç”Ÿæˆã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
- **è¨ºæ–­æ©Ÿèƒ½è¿½åŠ **: åŒ…æ‹¬çš„ãªéŸ³å£°ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­ã¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ç¾¤
  - `testFaustDSP()`: Faust DSPå‹•ä½œç¢ºèª
  - `monitorFaustState()`: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç›£è¦–
  - `diagnoseAudioChain()`: éŸ³å£°ãƒã‚§ãƒ¼ãƒ³å…¨ä½“è¨ºæ–­
  - `enablePureSynthMode()`: ç´”ç²‹ã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼ãƒ¢ãƒ¼ãƒ‰
  - `startContinuousMonitor()`: ç¶™ç¶šçš„ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–

#### **ã‚³ãƒ¼ãƒ‰å¤‰æ›´è©³ç´°**
- **audioCore.tsä¿®æ­£**:
  - ç«¶åˆã™ã‚‹åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã‚’å‰Šé™¤ã—ã¦DSPãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’å°Šé‡
  - AudioContext keep-aliveã‚¿ã‚¤ãƒãƒ¼è¿½åŠ ï¼ˆ5ç§’é–“éš”ã€è‡ªå‹•suspensionæ¤œå‡ºãƒ»å¾©æ—§ï¼‰
  - éŸ³å£°æ¥ç¶šã®ç¢ºå®Ÿãªå‚ç…§ä¿æŒæ©Ÿæ§‹è¿½åŠ 
  - MicRouteræœªæ¥ç¶šæ™‚ã®silent inputç”Ÿæˆ
- **controller.tsæ‹¡å¼µ**:
  - åŒ…æ‹¬çš„è¨ºæ–­æ©Ÿèƒ½ç¾¤è¿½åŠ ï¼ˆ5ç¨®é¡ã®è¨ºæ–­ãƒ»ç›£è¦–é–¢æ•°ï¼‰
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹è¡¨ç¤º
  - Faust DSPãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨æ¥ç¶šçŠ¶æ…‹ã®è©³ç´°ãƒ­ã‚°å‡ºåŠ›

#### **å‹•ä½œç¢ºèªæ¸ˆã¿æ©Ÿèƒ½**
- **DSPéŸ³å£°å‡ºåŠ›**: Faust DSPã«ã‚ˆã‚‹åˆæˆéŸ³ãŒæ­£å¸¸ã«å‡ºåŠ›
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡**: freq/gainã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ¶å¾¡
- **éŸ³å£°å®‰å®šæ€§**: é•·æ™‚é–“å†ç”Ÿã§ã®éŸ³å£°ç¶™ç¶šæ€§ç¢ºä¿
- **è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ **: åŒ…æ‹¬çš„ãªéŸ³å£°ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç›£è¦–ã¨å•é¡Œæ¤œå‡º

#### **æŠ€è¡“çš„å­¦ç¿’äº‹é …**
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç«¶åˆå›é¿**: DSPå´ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æœ€å„ªå…ˆã—ã€ã‚³ãƒ¼ãƒ‰å´åˆæœŸåŒ–ã¯å‰Šé™¤
- **AudioContextç®¡ç†**: ãƒ–ãƒ©ã‚¦ã‚¶ã®è‡ªå‹•suspensionå¯¾ç­–ã¨ã—ã¦èƒ½å‹•çš„keep-aliveå¿…é ˆ
- **å‚ç…§ç®¡ç†**: Web Audio APIãƒãƒ¼ãƒ‰ã®ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é˜²æ­¢ç­–ã®é‡è¦æ€§
- **è¨ºæ–­é‡è¦æ€§**: è¤‡é›‘ãªéŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã§ã¯åŒ…æ‹¬çš„è¨ºæ–­æ©Ÿèƒ½ãŒå•é¡Œè§£æ±ºã«ä¸å¯æ¬ 

### 2025-08-18 Phase 1: å®Ÿéš›ã®Faust WASMçµ±åˆå®Ÿè£…å®Œäº† âœ…
**æ¦‚è¦**: ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã®GainNodeã‚’å®Ÿéš›ã®Faust AudioWorkletNodeã«ç½®æ›ã€DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°ã®å®Œå…¨è‡ªå‹•åŒ–ã‚’å®Ÿç¾ã€‚

#### **Step 1: FaustWasmLoaderå®Ÿè£…**
- **æ–°ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/dsp/faustWasmLoader.ts` (190è¡Œ)
- **æ©Ÿèƒ½å®Ÿè£…**:
  - FaustWasmåˆæœŸåŒ–: `instantiateFaustModuleFromFile` + `LibFaust` + `FaustCompiler`
  - DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«: `.dsp`ãƒ•ã‚¡ã‚¤ãƒ«â†’`FaustMonoDspGenerator`â†’AudioWorkletNodeç”Ÿæˆ
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•æŠ½å‡º: `node.getParams()`ã‹ã‚‰UIæƒ…å ±å–å¾—ãƒ»æ­£è¦åŒ–
  - ç”Ÿæˆã‚­ãƒ£ãƒƒã‚·ãƒ¥: moduleCache, libFaust, compiler ã®å†åˆ©ç”¨
- **APIè¨­è¨ˆ**:
  ```typescript
  loadFaustNode(ctx: AudioContext, dspName: string): Promise<FaustMonoAudioWorkletNode>
  getParameterInfo(dspName: string): FaustParamInfo[]
  scanAvailableDSP(basePath: string): Promise<string[]>
  ```

#### **Step 2: EffectRegistry v2çµ±åˆ**
- **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/effects/effectRegistry.ts`
- **ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ç½®æ›**:
  - `registerDSPFromFile()`: GainNode â†’ FaustWasmLoader.loadFaustNode()
  - `registerPrecompiledFaust()`: åŒæ§˜ã«GainNode â†’ å®ŸWASM
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: WASMå¤±æ•—æ™‚ã¯GainNodeãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå®‰å…¨æ€§ç¢ºä¿ï¼‰
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°å¼·åŒ–**:
  - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿(.json)ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å„ªå…ˆã€FaustWasmè‡ªå‹•æŠ½å‡ºã‚’è£œå®Œ
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åæ­£è¦åŒ–: label â†’ idå¤‰æ›ï¼ˆå°æ–‡å­—ãƒ»ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒ–ï¼‰

#### **Step 3: FaustEffectControllerå¼·åŒ–**
- **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/dsp/faustEffectController.ts`
- **setParamæ”¹å–„**:
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¿½åŠ ã€ãƒ­ã‚°å‡ºåŠ›å¼·åŒ–
  - `setParamValue`ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨ãƒã‚§ãƒƒã‚¯ãƒ»å‹å®‰å…¨æ€§å‘ä¸Š
  - ç¯„å›²ã‚¯ãƒ©ãƒ³ãƒ”ãƒ³ã‚°ç¶­æŒï¼ˆmin/maxåˆ¶ç´„ï¼‰

#### **Step 4: åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ **
- **æ–°ãƒ•ã‚¡ã‚¤ãƒ«**: `src/phase1TestFunctions.ts` (180è¡Œ)
- **ãƒ†ã‚¹ãƒˆé–¢æ•°ç¾¤**:
  - `testFaustWasmIntegration()`: WASMå˜ä½“ãƒ†ã‚¹ãƒˆãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¢ºèª
  - `testEffectRegistryV2()`: EffectRegistryçµ±åˆãƒ†ã‚¹ãƒˆ
  - `testMysynthCreation()`: mysynthå®ŸéŸ³å£°æ¥ç¶šãƒ†ã‚¹ãƒˆ
  - `showRegisteredEffects()`: ç™»éŒ²æ¸ˆã¿ã‚¨ãƒ•ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤º
- **é–‹ç™ºè€…ä½“é¨“**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å³åº§ã«å®Ÿè¡Œå¯èƒ½ã€æ®µéšçš„ãƒ‡ãƒãƒƒã‚°å¯¾å¿œ

#### **æŠ€è¡“çš„å®Ÿè£…è©³ç´°**
- **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ•ãƒ­ãƒ¼**: `.dsp` â†’ `FaustCompiler` â†’ `FaustMonoDspGenerator` â†’ `AudioWorkletNode`
- **æ—¢å­˜APIäº’æ›**: audioCore.tsã®`applyFaustDSP()`ã¨ã®ä¸¦è¡Œé‹ç”¨
- **ã‚¨ãƒ©ãƒ¼åˆ†é›¢**: WASMå¤±æ•—ã§ã‚‚GainNodeãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã¸ã®å½±éŸ¿å›é¿
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³Loaderã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©/ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å†åˆ©ç”¨

#### **å‹•ä½œç¢ºèªé …ç›®**
âœ… `.dsp`ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ¤œå‡ºãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«  
âœ… `mysynth.dsp` â†’ å®ŸAudioWorkletNodeç”Ÿæˆ  
âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•æŠ½å‡ºãƒ»UIæƒ…å ±ãƒãƒƒãƒ”ãƒ³ã‚°  
âœ… `setParamValue('/mysynth/freq', 440)` ã«ã‚ˆã‚‹å®Ÿæ™‚é–“åˆ¶å¾¡  
âœ… EffectRegistry v2ã§ã®mysynthç”Ÿæˆï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€æ’¤å»ƒï¼‰  
âœ… ã‚¨ãƒ©ãƒ¼æ™‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‹•ä½œ  

#### **æ¬¡æ®µéšã¸ã®å½±éŸ¿**
- **Track Lifecycle Manager**: å®ŸFaustNodeã§ã®Trackç”Ÿæˆãƒ»ç ´æ£„ãƒ†ã‚¹ãƒˆå¯èƒ½
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿UI**: è‡ªå‹•æŠ½å‡ºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®å‹•çš„UIç”ŸæˆåŸºç›¤ç¢ºç«‹
- **ãƒ—ãƒªã‚»ãƒƒãƒˆç®¡ç†**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ä¸€æ‹¬è¨­å®šãƒ»ä¿å­˜æ©Ÿèƒ½ã®æ‹¡å¼µæº–å‚™å®Œäº†

#### **é‡è¦ãªæŠ€è¡“çš„ç™ºè¦‹**
- **FaustWasm APIå¤‰æ›´**: `FaustWasm` â†’ `LibFaust` + `FaustCompiler`ãƒ‘ã‚¿ãƒ¼ãƒ³å¿…é ˆ
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—**: `node.getParams()`ã¯éåŒæœŸã€try-catchå¿…é ˆ
- **AudioWorkletåˆ¶ç´„**: `gen.load(ctx.audioWorklet)`ãŒå¿…è¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¾å­˜ã‚ã‚Š

### 2025-08-18 DSPãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° âœ…
**æ¦‚è¦**: DSPãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚«ãƒ†ã‚´ãƒªåˆ¥æ•´ç†ã¨EffectRegistry v2å®Ÿè£…æº–å‚™ã€‚

#### **ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆå¤‰æ›´**
- **æ–°æ§‹æˆ**: 
  ```
  public/dsp/
    â”œâ”€â”€ mysynth.dsp (æ—¢å­˜ãƒ»ãƒ¡ã‚¤ãƒ³ã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼)
    â”œâ”€â”€ testsignals.dsp (æ—¢å­˜ãƒ»ãƒ†ã‚¹ãƒˆä¿¡å·)
    â”œâ”€â”€ synths/ (æ–°è¦ãƒ»ã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼ç³»DSPç”¨)
    â””â”€â”€ effects/ (æ–°è¦ãƒ»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç³»DSPç”¨)
  ```
- **ç›®çš„**: EffectRegistry v2ã§ã®ã‚«ãƒ†ã‚´ãƒªåˆ¥ç®¡ç†ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ­ãƒ¼ãƒ‰ã®æº–å‚™
- **å°†æ¥ã®é…ç½®æ–¹é‡**:
  - `synths/`: éŸ³æºç”Ÿæˆç³»DSPï¼ˆoscillator, sampler, noise generatorç­‰ï¼‰
  - `effects/`: éŸ³éŸ¿å‡¦ç†ç³»DSPï¼ˆreverb, filter, compressorç­‰ï¼‰
  - ãƒ«ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«: æ—¢å­˜äº’æ›ãƒ»ç‰¹åˆ¥ç”¨é€”DSP

#### **EffectRegistry v2ã¸ã®å½±éŸ¿**
- **ãƒ‘ã‚¹è§£æ±º**: ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®è‡ªå‹•æ¤œç´¢å¯¾å¿œ
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: å„ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¯¾å¿œã™ã‚‹.jsonãƒ•ã‚¡ã‚¤ãƒ«é…ç½®äºˆå®š
- **ãƒ­ãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯**: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã«åŸºã¥ãã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ¤å®šæ©Ÿèƒ½

### 2025-08-18 EffectRegistry v2 å®Œå…¨å®Ÿè£…å®Œäº† âœ…
**æ¦‚è¦**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ã«ã‚ˆã‚‹åŒ…æ‹¬çš„ãªã‚¨ãƒ•ã‚§ã‚¯ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨å®Ÿè£…ã¨çµ±åˆã€‚

#### **Phase 1: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æ‹¡å¼µå®Œäº†**
- **æ–°å‹å®šç¾©**:
  - `EffectCategory`: 'source' | 'effect' | 'hybrid' | 'utility'
  - `DSPCompatibility`: é…ç½®å¯èƒ½æ€§åˆ¤å®šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - `EffectRegistryEntry`: dspPath, compatibility, subCategory ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
- **ã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ¤å®š**: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‹ã‚‰ã®åˆæœŸã‚«ãƒ†ã‚´ãƒªæ¨å®šæ©Ÿèƒ½
- **æ—¢å­˜ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæ›´æ–°**: Gain/LPF/Delay ã® compatibility æƒ…å ±è¿½åŠ 

#### **Phase 2: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…**
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**: 
  - `public/dsp/mysynth.json`: mysynth.dspç”¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¾‹
  - refId, category, compatibility, params ã®åŒ…æ‹¬çš„è¨˜è¿°
- **è‡ªå‹•æ¤œç´¢ãƒ»ç™»éŒ²æ©Ÿèƒ½**: `scanAndRegisterDSPFiles()` å®Ÿè£…
  - DSPãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ãƒšã‚¢ãƒªãƒ³ã‚°
  - åˆæœŸåŒ–æ™‚ã®è‡ªå‹•ç™»éŒ²ãƒ—ãƒ­ã‚»ã‚¹çµ±åˆ

#### **Phase 3: UIçµ±åˆå®Œäº†**
- **ControlleråˆæœŸåŒ–**: Base Audioæº–å‚™æ™‚ã«DSP auto-scanè¿½åŠ 
- **Effects Chainæ‹¡å¼µ**: ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ ãƒœã‚¿ãƒ³å®Ÿè£…
- **è¦–è¦šçš„æ”¹å–„**: ã‚«ãƒ†ã‚´ãƒªåˆ¥è‰²åˆ†ã‘æ©Ÿèƒ½
  - Source: ç·‘ / Effect: é’ / Hybrid: ç´« / Utility: ç°

#### **Phase 4: ãƒã‚°ä¿®æ­£ã¨ã‚·ã‚¹ãƒ†ãƒ å®‰å®šåŒ–å®Œäº†**
- **8ä»¶ã®ä¸»è¦ãƒã‚°ä¿®æ­£**:
  - ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼æ”¹å–„
  - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒã‚§ãƒ¼ãƒ³ç®¡ç†ã®æœ€é©åŒ–
  - ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
  - UIå¿œç­”æ€§ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ”¹å–„
- **TrackéŸ³é‡åˆ¶å¾¡å•é¡Œè§£æ±º**: Faustãƒˆãƒ©ãƒƒã‚¯éŸ³é‡ãŒ0ã¾ã§ä¸‹ãŒã‚‰ãªã„å•é¡Œã‚’é‡è¤‡æ¥ç¶šæ’é™¤ã§è§£æ±º
- **UIç°¡ç´ åŒ–**: å†—é•·ãªåˆ¶å¾¡è¦ç´ ã¨å±é™ºãªãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®å‰Šé™¤
  - Audio Engine ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³å‰Šé™¤ï¼ˆè‡ªå‹•èµ·å‹•ã«çµ±ä¸€ï¼‰
  - é‡è¤‡MasteréŸ³é‡åˆ¶å¾¡å‰Šé™¤
  - å±é™ºãªDirect Audio Testæ©Ÿèƒ½å®Œå…¨å‰Šé™¤

#### **æŠ€è¡“çš„å®Ÿè£…è©³ç´°**
- **ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ **: Promise ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹å¤šé‡è¦æ±‚æŠ‘æ­¢
- **å‹å®‰å…¨æ€§**: å…¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®TypeScriptå‹å®šç¾©å®Œå‚™
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- **å¾Œæ–¹äº’æ›æ€§**: æ—¢å­˜ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¨ã®çµ±åˆç¶­æŒ
- **éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æœ€é©åŒ–**: é‡è¤‡æ¥ç¶šé˜²æ­¢ã¨ã‚¯ãƒªãƒ¼ãƒ³ãªãƒã‚§ãƒ¼ãƒ³ç®¡ç†
- **è¨ºæ–­æ©Ÿèƒ½**: åŒ…æ‹¬çš„ãªã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½

#### **å®Œæˆã—ãŸæ©Ÿèƒ½ç¾¤**
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç®¡ç†**: DSPãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ãƒšã‚¢ãƒªãƒ³ã‚°
- **ã‚«ãƒ†ã‚´ãƒªãƒ™ãƒ¼ã‚¹åˆ†é¡**: source/effect/hybrid/utility è‡ªå‹•åˆ†é¡
- **è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ã‚«ãƒ†ã‚´ãƒªåˆ¥è‰²åˆ†ã‘ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
- **å®‰å…¨ãªæ“ä½œç’°å¢ƒ**: å±é™ºãªç›´æ¥æ“ä½œæ©Ÿèƒ½ã®å®Œå…¨æ’é™¤
- **ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ©ã‚¤ãƒ³åŒ–ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**: ä¸€è²«ã—ãŸæ“ä½œä½“é¨“

#### **å“è³ªæŒ‡æ¨™**
- **ãƒã‚°è§£æ±ºç‡**: 100% (8/8ä»¶å®Œäº†)
- **ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§**: éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®é‡è¤‡å•é¡Œè§£æ±º
- **UIå®‰å…¨æ€§**: å±é™ºæ©Ÿèƒ½å®Œå…¨å‰Šé™¤ã«ã‚ˆã‚‹å®‰å…¨ãªæ“ä½œç’°å¢ƒç¢ºç«‹
- **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: å†—é•·è¦ç´ å‰Šé™¤ã«ã‚ˆã‚‹æ“ä½œæ˜ç¢ºåŒ–

#### **å‹•ä½œç¢ºèªæ¸ˆã¿æ©Ÿèƒ½**
âœ… Base Audio å˜ç‹¬åˆæœŸåŒ– â†’ ãƒ†ã‚¹ãƒˆä¿¡å·å‹•ä½œ  
âœ… å¾“æ¥ãƒ•ãƒ­ãƒ¼ (Apply DSP) â†’ å…¨æ©Ÿèƒ½æ­£å¸¸å‹•ä½œ  
âœ… Logic Input Tone/Noise/Impulse ãƒœã‚¿ãƒ³ â†’ éŸ³å£°å‡ºåŠ›ç¢ºèª  
âœ… Direct Audio Test â†’ outputGainNode ç›´æ¥å‡ºåŠ›ç¢ºèª  
âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ é©åˆ‡ãªã‚¬ã‚¤ãƒ€ãƒ³ã‚¹è¡¨ç¤º  

#### **åŠ¹æœãƒ»æ„ç¾©**
- **UX æ”¹å–„**: DSP é©ç”¨å‰ã§ã‚‚ Logic Inputs ã®ãƒ†ã‚¹ãƒˆä¿¡å·ãŒå³åº§ã«åˆ©ç”¨å¯èƒ½
- **é–‹ç™ºåŠ¹ç‡**: Base Audio å±¤ã§ã®éŸ³å£°ãƒ†ã‚¹ãƒˆãŒé«˜é€ŸåŒ–
- **ä¿å®ˆæ€§**: ãƒ†ã‚¹ãƒˆä¿¡å·ç”Ÿæˆã®ä¸€å…ƒåŒ–, é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- **æ‹¡å¼µæ€§**: TestSignalManager ã«ã‚ˆã‚‹å°†æ¥çš„ãªä¿¡å·ç¨®é¡è¿½åŠ åŸºç›¤
- **å¾Œæ–¹äº’æ›**: æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«å½±éŸ¿ãªã—

#### **æ¬¡æœŸå®Ÿè£…ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ** 
**Track Lifecycle Manager**: DSP æœ‰åŠ¹åŒ–æ™‚ã® Track è‡ªå‹•ç”Ÿæˆãƒ»ç ´æ£„ã¨ 15-20ms ãƒ•ã‚§ãƒ¼ãƒ‰å‡¦ç†ã«ã‚ˆã‚‹ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºå®Œå…¨æ’é™¤

### 2025-08-11 Master ãƒ¡ãƒ¼ã‚¿è¿½åŠ  & ãƒ†ã‚¹ãƒˆéŸ³ã‚¨ãƒ©ãƒ¼æ”¹å–„
- controller.ts: Master è¡Œã«ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿+dBè¡¨ç¤ºã‚’è¿½åŠ  (outputGainNode ç›´å‰ã§æ¸¬å®š)ã€‚
- routingUI.ts: ãƒ†ã‚¹ãƒˆéŸ³æ³¨å…¥å‰ã« AudioContext/BusManager æœªåˆæœŸåŒ–æ™‚ã¯ã‚¢ãƒ©ãƒ¼ãƒˆã§ Apply DSP ã‚’è¦æ±‚ã€‚
- å‹•ä½œ: Master ãƒ¡ãƒ¼ã‚¿ã¯ FaustSynth+TrackVolume+MasterFX å¾Œã®æœ€çµ‚ãƒ¬ãƒ™ãƒ«ã‚’è¡¨ç¤ºã€‚ãƒ†ã‚¹ãƒˆéŸ³ã¯å‰ææ¡ä»¶ä¸è¶³æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰ã€‚
- TODO: analyser ã®ä½œæˆ/ç ´æ£„ã‚’æœ€é©åŒ– (ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŒ–) / ãƒ†ã‚¹ãƒˆéŸ³ã® DSP ãƒ™ãƒ¼ã‚¹å®Ÿè£… (testsignals.dsp çµ±åˆ)ã€‚

### 2025-08-11 Master FX é…å»¶ã‚­ãƒ¥ãƒ¼æ‹¡å¼µ
- busManager: enqueueFxOp / flushFxOps / applyFxOp ã‚’è¿½åŠ ã— add/remove/move/bypass/clear ã‚’é…å»¶ã‚­ãƒ¥ãƒ¼å¯¾å¿œã€‚
- controller: æ—¢å­˜ masterFxQueue ã‚’æ±ç”¨ action å½¢å¼ã¸æ‹¡å¼µã— UI æ“ä½œå…¨ã¦ enqueueã€‚
- ç›®çš„: ã‚¨ãƒ³ã‚¸ãƒ³æœªåˆæœŸåŒ–æ™‚ã‚‚ä¸€é€£ã®ç·¨é›†æ“ä½œã‚’é †ç•ªç¶­æŒã—ã¦é©ç”¨å¯èƒ½ã«ã€‚
- TODO: registrar çµ±åˆå¾Œã¯ refId ãƒ™ãƒ¼ã‚¹ add ã¸ç§»è¡Œã€‚

### 2025-08-11 LogicInput åˆæœŸ Enable OFF / ãƒ†ã‚¹ãƒˆéŸ³æ”¹å–„ / testsignals.dsp è¿½åŠ 
- LogicInputManager.add(): enabled ã‚’å¸¸ã« false åˆæœŸåŒ– (æ˜ç¤º)ã€‚
- routingUI: ãƒ†ã‚¹ãƒˆéŸ³æ³¨å…¥å‰ã« ensureInput + ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…¨OFFæ™‚ã¯ monitor ã‚’ä¸€æ™‚true ã«ã—ã¦å†ç”Ÿå¾Œæˆ»ã™ã€‚
- è¿½åŠ : public/dsp/testsignals.dsp (å°†æ¥ Worklet åŒ–ã—ã¦çµ±ä¸€çš„ã«ãƒ†ã‚¹ãƒˆä¿¡å·ç”Ÿæˆäºˆå®š)ã€‚
- ç›®çš„: åˆæœŸçŠ¶æ…‹ã§å‹æ‰‹ã«éŸ³ãŒé³´ã‚‰ãªã„å®‰å…¨å´ã€å¿…è¦ãªã¨ãã«ç¢ºå®Ÿã«ãƒ†ã‚¹ãƒˆéŸ³å‡ºã›ã‚‹ã‚ˆã†æ”¹å–„ã€‚
- TODO: testsignals.dsp ã‚’è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ã—ã¦å°‚ç”¨ Track / Param UI ã‹ã‚‰é¸æŠå†ç”Ÿã™ã‚‹çµ±åˆ (å¾Œæ®µ)ã€‚

### 2025-08-11 Step3: è«–ç†Input ãƒ†ã‚¹ãƒˆéŸ³ & å…¥åŠ›ãƒ¡ãƒ¼ã‚¿è¿½åŠ 
- è¿½åŠ : `routingUI.ts` ã« Tone / Noise / Imp ãƒœã‚¿ãƒ³ (440Hz 0.5s, ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚º 0.5s, ã‚¤ãƒ³ãƒ‘ãƒ«ã‚¹ 0.1s) ã‚’å„è«–ç†Inputè¡Œã¸ã€‚
- è¿½åŠ : ç°¡æ˜“å…¥åŠ›ãƒ¡ãƒ¼ã‚¿ (RMSâ†’éç·šå½¢å¤‰æ›) ã‚’ per LogicInput è¡¨ç¤ºã€‚
- è¿½åŠ : `busManager.ts` ã« getInputGainNode(logicId) ã‚²ãƒƒã‚¿ãƒ¼ï¼ˆãƒ†ã‚¹ãƒˆéŸ³æ³¨å…¥/ãƒ¡ãƒ¼ã‚¿æ¥ç¶šç”¨ï¼‰ã€‚
- å®Ÿè£…ãƒ¡ãƒ¢: ç¾çŠ¶ãƒ¡ãƒ¼ã‚¿ã¯ rAF ã”ã¨ã«ä¸€æ™‚ AnalyserNode ã‚’ä½œæˆâ†’æ¥ç¶šâ†’å€¤å–å¾—â†’åˆ‡æ–­ï¼ˆä½ãƒãƒ£ãƒ³ãƒãƒ«æ•°æƒ³å®šã§è² è·è»½å¾®ï¼‰ã€‚å¿…è¦ãªã‚‰æ°¸ç¶š Analyser ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¸æœ€é©åŒ–äºˆå®šã€‚
- TODO: ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹æœªã‚¢ã‚µã‚¤ãƒ³æ™‚ã¯ Tone/Noise/Imp ã‚’è‡ªå‹•ã§ sourceNode ã«æ¥ç¶šorè­¦å‘Šè¡¨ç¤ºã€Clear/Persist äºˆç´„ã€‚

### 2025-08-11 Track Volume æœªåæ˜ ãƒã‚°ä¿®æ­£
- åŸå› : Faustãƒãƒ¼ãƒ‰ã‚’ç›´æ¥ master effectsBus (effectsInput) ã«æ¥ç¶šã—ã¦ãŠã‚Š Track.volumeGain ã‚’çµŒç”±ã—ã¦ã„ãªã‹ã£ãŸãŸã‚ã€UIã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å¤‰æ›´ (userVolumeâ†’volumeGain.gain) ãŒå®Ÿå‡ºåŠ›ã«å½±éŸ¿ã—ãªã‹ã£ãŸã€‚
- å¯¾å¿œ: audioCore ã§ã®ç›´æ¥æ¥ç¶šã‚’é™¤å»ã—ã€Trackç”Ÿæˆæ™‚ã« volumeGain -> effectsBus æ¥ç¶šã¸çµ±ä¸€ã€‚
- å½±éŸ¿: Track mute/solo/volume ãŒæ­£ã—ãå‡ºåŠ›ã¸åæ˜ ã€‚è¤‡æ•° Track æ‹¡å¼µæ™‚ã®ä¸€è²«æ€§å‘ä¸Šã€‚
- TODO: æ—¢å­˜æ¥ç¶šãŒå­˜åœ¨ã™ã‚‹å ´åˆã®å†åˆæœŸåŒ– (Apply DSP) ã‚·ãƒ¼ã‚±ãƒ³ã‚¹æœ€é©åŒ– (äºŒé‡æ¥ç¶šé˜²æ­¢) / Track dispose æ™‚ disconnect è¿½åŠ ç¢ºèªã€‚

### 2025-08-11 Master FX é…å»¶ã‚­ãƒ¥ãƒ¼ (æ¡ˆ4) å®Ÿè£…
- ç›®çš„: Audio Engine åˆæœŸåŒ–å‰ (DSPæœªãƒ­ãƒ¼ãƒ‰/permissionæœªå–å¾—) ã§ã‚‚ Master FX è¿½åŠ æ“ä½œã‚’äºˆç´„å¯èƒ½ã«ã™ã‚‹ã€‚
- å®Ÿè£…:
  - `controller.ts` ã« `masterFxQueue` (ç¾çŠ¶ addEffect ã®ã¿) ã‚’è¿½åŠ ã€‚
  - busManager æœªå®šç¾©æ™‚ã¯ã‚­ãƒ¥ãƒ¼ã¸ pushã€`audio-engine-initialized` ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ã§ flushã€‚
  - `audioCore.ts` ã§ busManager æ§‹ç¯‰å¾Œã« `audio-engine-initialized` CustomEvent ç™ºç«ã€‚
  - UI ãƒœã‚¿ãƒ³ (+Gain/+LPF/+Delay) ã¯ queueMasterFxAdd çµŒç”±ã«å¤‰æ›´ã€‚
- å‹•ä½œ: Audio Output OFF ã‚„ initAudio å‰ã§ã‚‚ FX ãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã°ã‚­ãƒ¥ãƒ¼ã«æºœã¾ã‚Šã€åˆæœŸåŒ–å¾Œä¸€æ‹¬é©ç”¨ã€‚
- åˆ¶é™ / TODO:
  - Clear æ“ä½œã¯ busManager å­˜åœ¨æ™‚ã®ã¿ (æœªå­˜åœ¨æ™‚ã®äºˆç´„æœªå¯¾å¿œ)ã€‚
  - remove/move/bypass ã®äºˆç´„ã¯æœªå®Ÿè£… (å¿…è¦ãªã‚‰ action æ‹¡å¼µ)ã€‚
  - é‡è¤‡æŠ¼ä¸‹ãƒã‚§ãƒƒã‚¯ã‚„æœ€å¤§é•·åˆ¶é™ã¯æœªå®Ÿè£… (å¿…è¦ã«å¿œã˜å°å…¥)ã€‚
- æ¬¡å€™è£œ:
  - äºˆç´„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®æ‹¡å¼µ (remove/move/bypass)
  - ã‚­ãƒ¥ãƒ¼è¡¨ç¤º/ã‚­ãƒ£ãƒ³ã‚»ãƒ« UI (ãƒ‡ãƒãƒƒã‚°ç”¨)
  - Track Insert FX ã«åŒæ§˜ã®é…å»¶ã‚­ãƒ¥ãƒ¼ä»•çµ„ã¿é©ç”¨æ¤œè¨

### 2025-08-11 Master FX ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ Rebuild å®Ÿè£…
- å¤‰æ›´: `busManager.ts` ã® `rebuildChain()` ã‚’å·®ã—æ›¿ãˆã€æ—§ãƒã‚§ãƒ¼ãƒ³ã¨æ–°ãƒã‚§ãƒ¼ãƒ³ã‚’ 20ms ç·šå½¢ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ã€‚
- å®Ÿè£…è©³ç´°:
  - æ—§ãƒã‚§ãƒ¼ãƒ³æœ«å°¾ã« tailGain ã‚’ä¿æŒã—ã€æ–°ãƒã‚§ãƒ¼ãƒ³ã«æ–° tailGain ã‚’ç”Ÿæˆã€‚
  - crossfadeDuration(20ms) ä¸­ã« old.tailGain.gain â†’ 0, new.tailGain.gain â†’ 1 ã¸ linearRampã€‚
  - ãƒ•ã‚§ãƒ¼ãƒ‰å®Œäº†å¾Œã«æ—§ãƒãƒ¼ãƒ‰ã‚’é…å»¶ disconnect (ä½™è£• 60ms)ã€‚
  - å³æ™‚åˆ‡æ›¿æ™‚ (crossfadeEnabled=false) ã¯ä»¥å‰ã®æŒ™å‹•(ã‚¯ãƒªãƒƒã‚¯å¯èƒ½æ€§ã‚ã‚Š)ã€‚
- ç›®çš„: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ /å‰Šé™¤/é †åºå¤‰æ›´æ™‚ã®ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºä½æ¸›ã€‚
- åˆ¶é™ / TODO:
  - å€‹åˆ¥ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ bypass ãƒˆã‚°ãƒ«ã‚‚ãƒ•ãƒ«ãƒã‚§ãƒ¼ãƒ³å†æ§‹ç¯‰ (æœ€é©åŒ–ä½™åœ°)
  - Feedback/Delayç³»ã§çŠ¶æ…‹å¼•ãç¶™ãä¸å¯ (ãƒãƒ³ãƒƒã¨ãƒªã‚»ãƒƒãƒˆæ„Ÿ) â†’ å°†æ¥: ãƒãƒ¼ãƒ‰ç¨®åˆ¥ã”ã¨çŠ¶æ…‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¤œè¨
  - crossfadeDuration ã‚’å¯å¤‰è¨­å®šã«ã™ã‚‹ dev API æœªæä¾›

### 2025-08-11 Master FX ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æœ‰åŠ¹åŒ– & æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å€™è£œ
- å¤‰æ›´: `audioCore.ts` ã§ `faustNode` å‡ºåŠ›å…ˆã‚’ `outputGainNode` ç›´çµã‹ã‚‰ `busManager.effectsBus` ã¸å¤‰æ›´ (`getEffectsInputNode()` æ–°è¨­)ã€‚
- è¿½åŠ : `busManager.ts` ã« `getEffectsInputNode()` ã‚²ãƒƒã‚¿ãƒ¼ã€‚
- çµæœ: Master Effects Chain ãƒ‘ãƒãƒ«ã§è¿½åŠ ã™ã‚‹ Gain / LPF / Delay ãŒå®Ÿéš›ã®åˆæˆéŸ³ã¸åæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
- æ³¨æ„: ç¾çŠ¶ãƒã‚§ãƒ¼ãƒ³å†æ§‹ç¯‰æ™‚ã¯ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºãŒç”Ÿã˜å¾—ã‚‹ (å³æ™‚disconnect/connect)ã€‚çŸ­æ™‚é–“ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰å°å…¥äºˆå®šã€‚
- æ—¢çŸ¥ã®åˆ¶é™:
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿UIãªã— (Gainå€¤, LPF freq/Q, DelayTime ã‚’ç›´æ¥æ“ä½œä¸å¯)
  - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ é †åºå¤‰æ›´æ™‚ã®ãƒã‚¤ã‚º / ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆè»½æ¸›æœªå®Ÿè£…
  - Trackåˆ¥ã‚¤ãƒ³ã‚µãƒ¼ãƒˆãƒã‚§ãƒ¼ãƒ³ã¨ã¯ç‹¬ç«‹ç®¡ç† (çµ±åˆ/å…±é€šAPIåŒ–æœªç€æ‰‹)
- æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å€™è£œ:
  1. Crossfade Rebuild Manager (æ—§/æ–°ãƒã‚§ãƒ¼ãƒ³ã‚’ä¸¦åˆ—+15msãƒ•ã‚§ãƒ¼ãƒ‰)
  2. Master Chain ã‚‚ EffectRegistry ãƒ™ãƒ¼ã‚¹ã¸ç§»è¡Œ (param èª­ã¿å‡ºã—å…±é€šåŒ–)
  3. `fxAPI.setParam(trackId,effectId,paramId,value)` å®Ÿè£… (Track Insert å…ˆè¡Œ)
  4. Persistence v2: Track.effects æ°¸ç¶šåŒ– (refId/params/bypass/order)
  5. Debug: ãƒã‚§ãƒ¼ãƒ³çŠ¶æ…‹/æ¥ç¶šã‚°ãƒ©ãƒ•ã‚’ console.table å‡ºåŠ›ã™ã‚‹ dev API

### 2025-08-10 å‹•çš„Faustã‚¨ãƒ•ã‚§ã‚¯ãƒˆæŒ¿å…¥ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ–¹é‡ (Draft)
- ç›®çš„: Reverb / Compressor ãªã©è¤‡æ•°ã® Faust DSP (ãŠã‚ˆã³ Web Audio ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒãƒ¼ãƒ‰) ã‚’ Track å˜ä½ã§å‹•çš„ã«è¿½åŠ ãƒ»å‰Šé™¤ãƒ»é †åºå¤‰æ›´ãƒ»ãƒã‚¤ãƒ‘ã‚¹ã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ /å¤–éƒ¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼/ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ“ä½œå¯èƒ½ã«ã™ã‚‹ã€‚
- æ–¹é‡å¤‰æ›´ç‚¹:
  - æ—¢å­˜: Master Effects Bus ã«å˜ä¸€ç›´åˆ—ãƒã‚§ãƒ¼ãƒ³ (GUI) â†’ ä»Šå¾Œ: Track ã”ã¨ã«ç‹¬ç«‹ã—ãŸ Insert Chain + (å¾Œæ®µ) Send/Aux Busã€‚
  - ãƒã‚§ãƒ¼ãƒ³ã¯å®£è¨€çš„ JSON (ProjectState) ã¨ãƒ©ãƒ³ã‚¿ã‚¤ãƒ æ“ä½œ API ã®ä¸¡å¯¾å¿œã€‚
  - Faust åŠ¹æœã¯å…±é€š Loader / ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’çµŒç”±ã—ã¦ AudioWorkletNode ã‚’ç”Ÿæˆã€‚æ—¢ã«ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ wasm/code ã¯å†åˆ©ç”¨ã€‚
- ã‚³ã‚¢æŠ½è±¡:
  - EffectRegistryEntry { refId, kind:'faust'|'native', create(ctx):Promise<EffectInstance>, params:[{id,label,addr?,min,max,default,scale?}] }
  - EffectInstance { id, node:AudioNode, kind, refId, bypass:boolean, paramMap:{ [paramId]: { set(v:number,time?:number):void } }, dispose() }
  - Track.effects: EffectInstance[] (é †åº = ã‚·ã‚°ãƒŠãƒ«ãƒ•ãƒ­ãƒ¼)
- API (window.fxAPI äºˆå®š):
  - add(trackId, refId, position?) â†’ effectId
  - remove(trackId, effectId)
  - move(trackId, effectId, newIndex)
  - setBypass(trackId, effectId, flag)
  - setParam(trackId, effectId, paramId, value, opts={time?, ramp?})
  - list(trackId) â†’ meta[]
  - loadPreset(trackId, presetName)
- ãƒ­ãƒ¼ãƒ‰æˆ¦ç•¥:
  - Faust dsp: äº‹å‰ãƒ“ãƒ«ãƒ‰ wasm + json (public/audio/*.wasm + *.json) ã‚’ fetch â†’ instantiate â†’ createNodeã€‚
  - ãƒã‚¤ãƒ†ã‚£ãƒ–: DynamicsCompressorNode, BiquadFilterNode, GainNode ãªã©ã€‚
- å·®ã—æ›¿ãˆ / æŒ¿å…¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  (MVP â†’ æ‹¡å¼µ):
  1. MVP: æ—¢å­˜ãƒã‚§ãƒ¼ãƒ³å…¨ disconnect â†’ å† connect (ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºå®¹èª)ã€‚
  2. æ‹¡å¼µ: ä¸¦åˆ— (æ—§ãƒã‚§ãƒ¼ãƒ³ / æ–°ãƒã‚§ãƒ¼ãƒ³) ã‚’ crossfadeGain(10â€“30ms) ã§ãƒ–ãƒ¬ãƒ³ãƒ‰ã—ãƒãƒƒãƒ—å›é¿ã€‚
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡:
  - Faust: address ("/effect/param") ã‚’ paramId ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã€‚setParamValue ç›´æ¥å‘¼ã³å‡ºã—ã€‚ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚
  - ãƒã‚¤ãƒ†ã‚£ãƒ–: AudioParam.linearRampToValueAtTime ã§æœ€å°ãƒãƒƒãƒ—ã€‚
- æ°¸ç¶šåŒ– (ProjectState v2 æ¡ˆ):
  - tracks[i].effectsChain = [{ refId, effectId, bypass, params:{paramId:value}, order }]
  - è¿½åŠ ãƒ­ãƒ¼ãƒ‰æ‰‹é †: createTrack â†’ for each effect entry load & setParam â†’ apply order â†’ apply bypassã€‚
- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚° (å¾Œæ®µ):
  - mappingTable: controllerKey â†’ { trackId,effectId,paramId, transform? }
  - MIDI/ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰/OSC input â†’ lookup â†’ fxAPI.setParamã€‚
- ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ (å¾Œæ®µ):
  - automationPoints: [{ trackId,effectId,paramId,time,value,curve }]
  - transport å®Ÿè£…å¾Œ scheduler ã§åæ˜ ã€‚
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°:
  - Loader å¤±æ•— â†’ placeholder GainNode (unity) + warning ãƒ­ã‚°ã€å†è©¦è¡Œå¯èƒ½ã€‚
  - Param ä¸åœ¨ â†’ ç„¡è¦– + ä¸€åº¦ã ã‘è­¦å‘Šã€‚
- æ€§èƒ½é…æ…®:
  - åŒä¸€ refId ã®å¤šé‡ãƒ­ãƒ¼ãƒ‰ã‚’ Promise ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€‚
  - å†é…ç·šå›æ•°å‰Šæ¸› (ãƒãƒƒãƒæ“ä½œ: move + setParam ã®é€£ç¶šã‚’ microtask æœ«å°¾ã§ä¸€æ‹¬ rebuild)ã€‚
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/å®‰å®šæ€§:
  - å¤–éƒ¨è¿½åŠ  dsp ãƒ‘ã‚¹ã¯ allowlist (public/dsp/effects/*)ã€‚
  - æœªçŸ¥ kind ã¯æ‹’å¦ã€‚
- GUI æ¬¡æ®µéš:
  - Track è¡Œã« fx ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ (æ•°/è­¦å‘Š) / ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¢ãƒ¼ãƒ€ãƒ« or ãƒ‘ãƒãƒ«ã€‚
  - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æŠ˜ã‚ŠãŸãŸã¿ UIã€‚

- å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ— (æ¨å¥¨é †):
  1. EffectRegistry + Faust / Native Loader æŠ½è±¡è¿½åŠ ã€‚
  2. Track.effects é…åˆ— + å˜ç´” rebuild å®Ÿè£… (MVP)ã€‚
  3. fxAPI å…¬é–‹ + åŸºæœ¬ add/remove/move/setParam/setBypassã€‚
  4. ProjectState ä¿å­˜/å¾©å…ƒã¸ chain åæ˜  (æš«å®š JSON)ã€‚
  5. Crossfade å·®ã—æ›¿ãˆ / ãƒãƒƒãƒå†æ§‹ç¯‰æœ€é©åŒ–ã€‚
  6. Controller Mapping / Automation ä¸‹åœ°ã€‚
  7. UI æ‹¡å¼µ (Trackã”ã¨è©³ç´°)ã€‚

- æ—¢å­˜ã¨ã®å·®åˆ†å½±éŸ¿: busManager ã® master ãƒã‚§ãƒ¼ãƒ³æ©Ÿèƒ½ã¯ä¿æŒã—ã¤ã¤ã€Track å˜ä½ãƒã‚§ãƒ¼ãƒ³ã¸æ®µéšç§»è¡Œã€‚ç¾è¡Œ GUI (Effects Chain ãƒ‘ãƒãƒ«) ã¯å½“é¢ master chain ãƒ‡ãƒãƒƒã‚°ç”¨ã¨ã—ã¦æ®‹ã™ã€‚

- è¦ç¢ºèª (ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ç­”å¸Œæœ›):
  1. Reverb / Compressor Faust ãƒ•ã‚¡ã‚¤ãƒ«ã¯äº‹å‰ãƒ“ãƒ«ãƒ‰(wasm)å‰æã‹ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«(compileråˆ©ç”¨)ã‚‚è¨±å¯ã‹ã€‚
  2. Track æ•°ã®æƒ³å®šä¸Šé™ (ä¾‹: 8 / 16 / 32 ?) â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥/å†é…ç·šæˆ¦ç•¥èª¿æ•´ã€‚
  3. ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ æ™‚ã®è¨±å®¹é…å»¶ (ms) ã¨ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºè¨±å®¹åº¦åˆã„ã€‚
  4. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•åŒ–ã®æ™‚é–“ç²¾åº¦è¦æ±‚ (ä¾‹: 5ms / 20ms / audio-rate ä¸è¦)ã€‚
  5. Controller ãƒãƒƒãƒ”ãƒ³ã‚°å¯¾è±¡: MIDI ã®ã¿ã‹ã€Gamepad / OSC / WebSocket ç­‰ã‚‚åˆæœŸã‹ã‚‰è¦–é‡ã«å…¥ã‚Œã‚‹ã‹ã€‚
  6. Persist å½¢å¼: æ—¢å­˜ localStorage åˆ†å‰² (tracksState / logicInputs) ã«çµ±åˆã™ã‚‹ã‹ã€æ–° ProjectState (å˜ä¸€ã‚­ãƒ¼) ã‚’æ—©æœŸå°å…¥ã™ã‚‹ã‹ã€‚
  7. Bypass å‹•ä½œ: å®Œå…¨åˆ‡æ–­ã‹ã€0dB pass-through (CPUæœ€å°å·®) ã‹å¸Œæœ›ã€‚
  8. å°†æ¥ã® Send/Aux (reverb å…±æœ‰) ã‚’å‰æã«ä»Šã‹ã‚‰ Bus/Effect ã‚’äºŒå±¤ (Insert vs Send) ã«åˆ†ã‘ã‚‹ã¹ãã‹ã€‚

---

### 2025-08-10 Effects Chain GUI (MVP)
- è¿½åŠ : `busManager.ts` ã« FXãƒã‚§ãƒ¼ãƒ³ãƒ¡ã‚¿ (`EffectsChainItem`) ã¨æ“ä½œAPI
  - `addEffect(type)`, `removeEffect(id)`, `toggleBypass(id)`, `moveEffect(id,newIndex)`, `getEffectsChainMeta()`
  - ãƒã‚§ãƒ¼ãƒ³å†æ§‹ç¯‰æ™‚ã« `effects-chain-changed` CustomEvent ç™ºç«
  - å¯¾å¿œãƒãƒ¼ãƒ‰ç¨®: gain / biquad(lowpass) / delay / fallback(gain)
- è¿½åŠ : `controller.ts` ã« FXãƒ‘ãƒãƒ« (å³ä¸‹Trackãƒ‘ãƒãƒ«å·¦å´) å¹…300px
  - Listè¡Œ: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹, bypass(On/Byp), â†‘, â†“, âœ•
  - è¿½åŠ ãƒœã‚¿ãƒ³: +Gain / +LPF / +Delay / Clear
  - ä¸¦ã³æ›¿ãˆ/å‰Šé™¤/ãƒã‚¤ãƒ‘ã‚¹æ“ä½œã§å³å†æ§‹ç¯‰ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å†æç”»
- è¨­è¨ˆæ–¹é‡: ç¾æ®µéšã§ã¯ãƒã‚¹ã‚¿ãƒ¼Effectsãƒã‚¹ã®ã¿å¯¾è±¡ã€‚å¾Œæ®µã§Trackåˆ¥ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã‚„Send/Auxæ‹¡å¼µäºˆå®šã€‚
- æœªå®Ÿè£…/TODO:
  - å„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿UI (Gainå€¤, Filter freq/Q, DelayTime/Feedbackç­‰)
  - Bypass æ™‚ã®é…å»¶ãƒ©ã‚¤ãƒ³ä¿æŒ/ãƒ•ã‚§ãƒ¼ãƒ‰ (ãƒãƒƒãƒ—å›é¿)
  - ä¿å­˜å½¢å¼ã¸ã®åæ˜  (Track/ProjectState v2 ã§ chain serialize)
  - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç¨®é¡ãƒ—ãƒ©ã‚¬ãƒ–ãƒ«åŒ– (ç™»éŒ²ãƒ†ãƒ¼ãƒ–ãƒ«åŒ–)
  - Drag & Drop ä¸¦ã³æ›¿ãˆ UI
  - Multi-select / ä¸€æ‹¬bypass

### 2025-08-10 DeviceDiscovery æ°¸ç¶šåŒ– & æœ‰åŠ¹ãƒˆã‚°ãƒ«è¿½åŠ 
- è¿½åŠ : `deviceDiscovery.ts` ã« localStorage æ°¸ç¶šåŒ– (key: `audioDevices/v1`).
  - ä¿å­˜: { version:1, devices:[{id,label,enabled,kind}...] }
  - åˆæœŸåŒ–æ™‚ã«æ—¢å­˜ state ã‚’ãƒ­ãƒ¼ãƒ‰â†’ enumerate ã§æœ€æ–°ãƒ‡ãƒã‚¤ã‚¹ã¸ enabled çŠ¶æ…‹ã‚’å¼•ãç¶™ãã€‚
- è¿½åŠ API: `setDeviceEnabled(id, enabled)` â†’ ã‚¤ãƒ™ãƒ³ãƒˆ `audio-device-enabled-changed` ç™ºç«ã€‚
- enumerate æ™‚: æ—¢å­˜ enabled çŠ¶æ…‹ã‚’ç¶­æŒ / æ–°è¦ã¯ trueã€‚
- ä»Šå¾Œ: UI å´ã§ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ON/OFFç®¡ç†ã‚’è«–ç†Inputã‚¢ã‚µã‚¤ãƒ³å‰ã«åæ˜ ã•ã›ã‚‹åŸºç›¤ã€‚
- TODO: ç„¡åŠ¹åŒ–ã•ã‚ŒãŸ input ãƒ‡ãƒã‚¤ã‚¹ã‚’è«–ç†Inputã‚»ãƒ¬ã‚¯ã‚¿ã¸ãƒ•ã‚£ãƒ«ã‚¿è¡¨ç¤º / Disabled è¡¨ç¤ºã€‚

### 2025-08-10 LogicInput persistence v3 æ‹¡å¼µ
- è¿½åŠ : `logicInputs.ts` ã‚’ v3 ã¸ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œã€‚
  - æ–° key: `logicInputs/v3` ( `{ version:3, inputs: [...] }` )
  - è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: `order` (è¡¨ç¤ºé †), `trackMixSnapshot` (å¯¾å¿œTrackæœªç”Ÿæˆæ™‚ã® volume/mute/solo è¨˜éŒ²é ˜åŸŸ, å°†æ¥çµ±åˆç”¨)
  - æ—¢å­˜ v2 / v1 ã‹ã‚‰ã®æ®µéšçš„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£… (èª­ã¿è¾¼ã¿å¾Œ v3 å½¢å¼ã§ä¿å­˜)
  - ä¸¦ã³é †æ­£è¦åŒ–: `normalizeOrder()` ã§æ¬ æ/é‡è¤‡ã‚’å†æ¡ç•ª
  - APIæ‹¡å¼µ:
    - `reorder(id,newIndex)` : LogicInput ä¸¦ã³æ›¿ãˆ + ã‚¤ãƒ™ãƒ³ãƒˆ `logic-inputs-reordered`
    - `updateTrackMixSnapshot(id, snapshot)` : ãƒŸãƒƒã‚¯ã‚¹çŠ¶æ…‹éƒ¨åˆ†ä¿å­˜ + ã‚¤ãƒ™ãƒ³ãƒˆ `logic-input-mix-snapshot-changed`
  - æ—¢å­˜: `setTrackId`, `setLabel`, `remove` ç­‰ã¯ v3 å¯¾å¿œæ¸ˆ
- ç†ç”±: Track å´æ°¸ç¶šåŒ–(v1)è¿½åŠ å¾Œã€è«–ç†Inputã¨Tracké–“ã®çŠ¶æ…‹çµ±åˆæº–å‚™ (å¾Œç¶šã§çµ±åˆ or ç‰‡å´é›†ç´„) ã®è¶³å ´ã‚’æ—©æœŸç¢ºä¿ã€‚
- TODO / æ¬¡æ®µéšå€™è£œ:
  1. Track å´ persistence v1 ã¨ `trackMixSnapshot` ã®é‡è¤‡é ˜åŸŸçµ±åˆæ–¹é‡è¨­è¨ˆ (v4 or ProjectState)
  2. reorder UI (ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—) ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— â†’ `reorder()` å‘¼ã³å‡ºã—
  3. Effects Chain GUI å®Ÿè£…æº–å‚™ (LogicInput åˆ—ã« FX çŠ¶æ…‹ã‚¢ã‚¤ã‚³ãƒ³äºˆå®š)
  4. `updateTrackMixSnapshot` ã‚’ Track ã‚¤ãƒ™ãƒ³ãƒˆ (mute/solo/volume) ã‹ã‚‰è‡ªå‹•åæ˜  (ã¾ã æœªæ¥ç¶š)
- ãƒªã‚¹ã‚¯: Track ID å†å‰²å½“ã§æ—§ snapshot ãŒå­¤ç«‹ã™ã‚‹å¯èƒ½æ€§ã€‚çŸ­æœŸã¯è¨±å®¹ã€‚å°†æ¥ ProjectState ã§æ˜ç¤ºçš„æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ äºˆå®šã€‚

### 2025-08-10 TrackçŠ¶æ…‹æ°¸ç¶šåŒ–(v1) è¿½åŠ 
- è¿½åŠ : `tracks.ts` ã«æœ€å°ã®æ°¸ç¶šåŒ–å±¤(v1) å®Ÿè£…ã€‚
  - ä¿å­˜å¯¾è±¡: `id`, `name`, `userVolume`, `muted`, `solo`
  - localStorage key: `tracksState/v1` (`{ version:1, tracks:[...] }` å½¢å¼)
  - åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¸€åº¦ã ã‘readã— `loadedTrackState` ã«ä¿æŒ â†’ Trackç”Ÿæˆæ™‚ `applyPersistentState()` ã§é©ç”¨ã€‚
  - å¤‰æ›´ãƒˆãƒªã‚¬: `track-volume-changed`, `tracks-changed`, `track-name-changed` ã‚’ãƒ•ãƒƒã‚¯ã— 120ms ãƒ‡ãƒã‚¦ãƒ³ã‚¹ã§ä¿å­˜ã€‚
- æ–¹é‡: LogicInput å´ persistence(v2) ã¨åˆ†é›¢ã—ã€å¾Œç¶šã§ ProjectState çµ±åˆ (v2 or v3)ã¸ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³äºˆå®šã€‚
- ç†ç”±: å…ˆã«ãƒŸã‚­ã‚·ãƒ³ã‚°ç³»(éŸ³é‡/mute/solo/åç§°) ã‚’å¤±ã‚ãªã„åŸºç›¤ã‚’ç¢ºä¿ã—ã€Effects Chain GUI ã‚„ Trackè¿½åŠ  UI ä½œæ¥­æ™‚ã®å†èª­è¾¼ã‚¹ãƒˆãƒ¬ã‚¹ã‚’å›é¿ã€‚
- åˆ¶é™ / æœªå®Ÿè£…:
  - `kind` ã‚„ `dspChain` å†…å®¹ã€routingã€è§£æãƒ¡ãƒ¼ã‚¿çŠ¶æ…‹ã¯æœªä¿å­˜ã€‚
  - LogicInput â†” Track ã® `trackId` ãƒªãƒ³ã‚¯çŠ¶æ…‹ã¯ LogicInput persistence ã«ä¾å­˜ï¼ˆçµ±åˆå¾Œv3ã§ä¸€æ‹¬ã«ã™ã‚‹ï¼‰ã€‚
  - å°†æ¥: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ v2 ã§ `kind`, routing snapshot, FX chain, order ã‚’è¿½åŠ äºˆå®šã€‚
- ãƒªã‚¹ã‚¯: Trackå‰Šé™¤ â†’ åŒIDå†åˆ©ç”¨æ™‚ã«éå» state ãŒé©ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã€‚çŸ­æœŸã¯è¨±å®¹ (IDç”Ÿæˆãƒãƒªã‚·ãƒ¼æ”¹è‰¯ã§å›é¿äºˆå®š)ã€‚
- æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³(å€™è£œå„ªå…ˆé †):
  1. LogicInput persistence v3 è¨­è¨ˆ (mute/solo/volume/name ã‚’çµ±åˆ or ãƒªãƒ³ã‚¯æ–¹é‡ç¢ºç«‹)
  2. Effects Chain GUI ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— (ãƒãƒ¼ãƒ‰åˆ—æŒ™ + remove + add placeholder)
  3. Virtual / MicTrack å‰Šé™¤çµŒè·¯ã§ `disposeTrack()` å‘¼ã³å‡ºã—ã®æœªå‡¦ç† TODO è§£æ¶ˆ
  4. Track reorder ã«å‚™ãˆãŸ order ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¿å­˜ (v2 schema æº–å‚™)
  5. Meteræ‹¡å¼µ (peak / clip hold ä¿å­˜ã¯ä¸è¦ã ãŒUIæœ€é©åŒ–)

### 2025-08-10 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²æ–¹é‡
- **èƒŒæ™¯:**
  - controller.tsãŒè‚¥å¤§åŒ–ã—ã€è«–ç†Inputãƒªã‚¹ãƒˆç®¡ç†ãƒ»ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ç®¡ç†ãƒ»ã‚¢ã‚µã‚¤ãƒ³UIãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°UIãªã©è²¬å‹™ãŒæ˜ç¢ºã«åˆ†ã‹ã‚Œã¦ããŸãŸã‚ã€ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§å‘ä¸Šã®ãŸã‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²ã‚’è¡Œã†ã€‚
- **åˆ†å‰²äºˆå®š:**
  1. `src/audio/logicInputs.ts` : è«–ç†Inputãƒªã‚¹ãƒˆã®ç®¡ç†ãƒ»ç·¨é›†ãƒ»ä¿å­˜
  2. `src/audio/deviceAssignment.ts` : è«–ç†Inputã¨ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã®ã‚¢ã‚µã‚¤ãƒ³ç®¡ç†ï¼ˆã‚»ãƒ¬ã‚¯ã‚¿UIå«ã‚€ï¼‰
  3. `src/audio/routingUI.ts` : ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°UIï¼ˆè«–ç†Inputå˜ä½ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚²ã‚¤ãƒ³è¨­å®šUIï¼‰
  4. `src/audio/physicalDevicePanel.ts` : ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§ãƒ»çŠ¶æ…‹è¡¨ç¤ºUI
  5. `src/controller.ts` : ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»å…¨ä½“åˆæœŸåŒ–ãƒ»å„UI/ãƒ­ã‚¸ãƒƒã‚¯ã®çµ±åˆã®ã¿
- **ãƒ¡ãƒªãƒƒãƒˆ:**
  - è²¬å‹™åˆ†é›¢ã«ã‚ˆã‚‹ä¿å®ˆæ€§ãƒ»ãƒ†ã‚¹ãƒˆæ€§ã®å‘ä¸Š
  - ä»Šå¾Œã®æ©Ÿèƒ½è¿½åŠ ã‚„UIåˆ·æ–°ã‚‚å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«è¡Œãˆã‚‹
  - ä½œå“å›ºæœ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚„UIã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ã‚‚å®¹æ˜“
- **æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**
  - ä¸Šè¨˜æ–¹é‡ã«å¾“ã„ã€æ®µéšçš„ã«åˆ†å‰²ãƒ»ç§»è¡Œã‚’é€²ã‚ã‚‹
  - åˆ†å‰²ãƒ»ç§»è¡Œã®é€²æ—ã¯æœ¬mdã«éšæ™‚è¿½è¨˜

### 2025-08-10 æ–¹é‡ä¿®æ­£: è«–ç†Inputãƒªã‚¹ãƒˆã¨ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã®ã‚¢ã‚µã‚¤ãƒ³åˆ†é›¢
- **èƒŒæ™¯:**
  - ã“ã‚Œã¾ã§ã®Mic Routing UIã¯ã€Œç‰©ç†/ä»®æƒ³MicTrackã‚’ä¸€å…ƒç®¡ç†ã—ã€ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã®æœ‰åŠ¹åŒ–ã‚„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ç›´æ¥æ“ä½œã€ã™ã‚‹å½¢ã ã£ãŸãŒã€Input/Output Device Listã¨æ©Ÿèƒ½ãŒé‡è¤‡ã—ã€æ›²ä¸­ã§ä½¿ã†Inputç•ªå·ï¼ˆè«–ç†Inputï¼‰ã¨ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã®åˆ†é›¢ãŒã§ãã¦ã„ãªã‹ã£ãŸã€‚
- **æ–°æ–¹é‡:**
  1. ã€Œæ›²ä¸­ã§ä½¿ã†Inputãƒªã‚¹ãƒˆï¼ˆè«–ç†Inputç•ªå·ï¼‰ã€ã‚’æ˜ç¤ºçš„ã«ç®¡ç†ã—ã€å„Inputã«ãƒ©ãƒ™ãƒ«ã‚„ç”¨é€”ãªã©ã®ãƒ¡ã‚¿æƒ…å ±ã‚’æŒãŸã›ã‚‹ã€‚
  2. ç‰©ç†Inputï¼ˆãƒ‡ãƒã‚¤ã‚¹ï¼‰ã¨è«–ç†Inputã®ã‚¢ã‚µã‚¤ãƒ³UIã‚’åˆ†é›¢ã€‚ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§ã¯çŠ¶æ…‹è¡¨ç¤ºã®ã¿ã«ç‰¹åŒ–ã—ã€è«–ç†Inputãƒªã‚¹ãƒˆã«ã¯ã€Œã©ã®ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã‚’ã‚¢ã‚µã‚¤ãƒ³ã™ã‚‹ã‹ã€ã‚’é¸æŠã™ã‚‹ã‚»ãƒ¬ã‚¯ã‚¿ã‚’è¨­ç½®ã€‚
  3. Mic Routing UIã¯ã€Œè«–ç†Inputãƒªã‚¹ãƒˆã®ç®¡ç†ãƒ»ã‚¢ã‚µã‚¤ãƒ³UIã€ã«ç½®ãæ›ãˆã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ã‚²ã‚¤ãƒ³ç­‰ã®è¨­å®šã¯è«–ç†Inputå˜ä½ã§è¡Œã†ã€‚
  4. ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ãŒæœªæ¥ç¶šã®å ´åˆã¯ã€Œæœªã‚¢ã‚µã‚¤ãƒ³ã€ã‚„ã€Œç„¡åŠ¹ã€ãªã©ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã€‚
- **UI/ãƒ‡ãƒ¼ã‚¿æ§‹é€ ä¾‹:**
    | Inputç•ªå· | ãƒ©ãƒ™ãƒ« | ã‚¢ã‚µã‚¤ãƒ³ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | ã‚²ã‚¤ãƒ³ |
    |-----------|--------|---------------------|--------------|--------|
    | 1         | Vocal  | å†…è”µãƒã‚¤ã‚¯          | Synth, Mon   | 1.0    |
    | 2         | Guitar | USB Audio           | Fx, Mon      | 0.8    |
    ...
    ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ãƒªã‚¹ãƒˆ:
    | ãƒ‡ãƒã‚¤ã‚¹å | çŠ¶æ…‹ |
    |------------|------|
    | å†…è”µãƒã‚¤ã‚¯ | æœ‰åŠ¹ |
    | USB Audio  | æœ‰åŠ¹ |
    ...
**ä»Šå¾Œã®å®Ÿè£…:**
  - è«–ç†Inputãƒªã‚¹ãƒˆã®ç®¡ç†ãƒ»ç·¨é›†ãƒ»ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ï¼ˆãƒã‚¤ã‚¯ãƒ»ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ä¸¡æ–¹ï¼‰ã®ã‚¢ã‚µã‚¤ãƒ³UIè¨­è¨ˆãƒ»å®Ÿè£…
  - å„ãƒ‡ãƒã‚¤ã‚¹ï¼ˆãƒã‚¤ã‚¯/ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ï¼‰ã«ã¯æœ‰åŠ¹/ç„¡åŠ¹ã®ãƒˆã‚°ãƒ«ã‚’è¨­ã‘ã‚‹
  - æ—¢å­˜ã®Mic Routing UIã¯å»ƒæ­¢ã¾ãŸã¯ç°¡ç´ åŒ–ã—ã€Input/Output Device Listã¯çŠ¶æ…‹è¡¨ç¤ºã«ç‰¹åŒ–
  - ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ã‚²ã‚¤ãƒ³ç­‰ã®è¨­å®šã¯è«–ç†Inputå˜ä½ã§è¡Œã†
  - ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã®æœ‰åŠ¹/ç„¡åŠ¹ã¯Input/Output Device Listã§ç®¡ç†
  - **å°†æ¥çš„ãªæ‹¡å¼µ:** å¤–éƒ¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚„MIDIãƒ‡ãƒã‚¤ã‚¹ç­‰ã‚‚åŒä¸€ãƒªã‚¹ãƒˆã§ã‚¢ã‚µã‚¤ãƒ³å¯èƒ½ã«ã™ã‚‹æ§‹æƒ³ã€‚ãŸã ã—ç¾æ®µéšã§ã¯ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ‡ãƒã‚¤ã‚¹ï¼ˆãƒã‚¤ã‚¯ãƒ»ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ï¼‰ã®ã¿å¯¾è±¡ã¨ã—ã€æ‹¡å¼µã—ã‚„ã™ã„æ§‹é€ ã¨ã™ã‚‹ã€‚
  - æ‹¡å¼µæ™‚ã¯ãƒ‡ãƒã‚¤ã‚¹ç¨®åˆ¥ã”ã¨ã«å¿…è¦ãªè¿½åŠ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¾‹: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ç”¨è¨­å®šç­‰ï¼‰ã‚’æŒã¦ã‚‹ã‚ˆã†ã«è¨­è¨ˆã™ã‚‹
  - å®Ÿè£…å¾Œã¯æœ¬mdã«é€²æ—ã‚’è¿½è¨˜ã™ã‚‹ã“ã¨

### 2025-08-10 Step2: MicTrackç”Ÿæˆãƒ»Trackãƒ™ãƒ¼ã‚¹åŒ–
- `src/audio/tracks.ts` ã« createMicTrack ã‚’è¿½åŠ 
- `src/audio/inputManager.ts` ã§ãƒã‚¤ã‚¯æœ‰åŠ¹åŒ–æ™‚ã«MicTrackã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ä¿®æ­£
- MicTrackã¯ gainNode ã‚’Trackã¨ã—ã¦ãƒ©ãƒƒãƒ—ã—ã€TrackListã«ç¾ã‚Œã‚‹
- æ—¢å­˜UIã‚„InputManagerã®å‹•ä½œã¯ç¶­æŒ
- æ°—ã¥ã: MicTrackç”Ÿæˆã¯ç‰©ç†ãƒã‚¤ã‚¯æœ‰åŠ¹åŒ–æ™‚ã®ã¿ã€‚ä»®æƒ³MicTrackã‚„äºˆç´„ã¯Step3ä»¥é™ã§æ¤œè¨

### 2025-08-10 Step1: Trackãƒ©ãƒƒãƒ— & audioAPIå°å…¥
- `src/audio/tracks.ts` æ–°è¦ä½œæˆã€Trackå‹ãƒ»createTrackEnvironmentãƒ»listTrackså®Ÿè£…
- `src/controller.ts` ã§initAudioå®Œäº†æ™‚ã«Trackç”Ÿæˆã€window.audioAPI.listTracks()å°å…¥
- æ—¢å­˜window.faustNodeäº’æ›ç¶­æŒã€UI/paramæ“ä½œã¯å¾“æ¥é€šã‚Šå‹•ä½œ
- æ°—ã¥ã: Trackå°å…¥å¾Œã‚‚æ—¢å­˜UIå£Šã•ãšæ®µéšç§»è¡Œå¯èƒ½ã€‚ä»Šå¾Œã¯MicTrackã‚„ParamRegistryæ‹¡å¼µã¸

### 2025-08-10 è¿½è¨˜: TrackListæœ€å°UI + mute/solo/volume ç®¡ç†å°å…¥
- è¿½åŠ : `tracks.ts` ã« userVolume ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ / applyMuteSoloState() / setTrackVolume() / toggleMute() / toggleSolo() / `tracks-changed` CustomEvent ç™ºç«
- è¿½åŠ : `controller.ts` ã«å›ºå®šä½ç½®ã®æœ€å° TrackList ãƒ‘ãƒãƒ«ï¼ˆName, Mute, Solo, Volume Sliderï¼‰
- å‹•ä½œ: Mute/ Solo çŠ¶æ…‹å¤‰æ›´æ™‚ã«å…¨Trackã¸åæ˜ ï¼ˆsoloå­˜åœ¨æ™‚ã¯soloä»¥å¤–0ï¼‰
- äº’æ›: æ—¢å­˜Faustãƒãƒ¼ãƒ‰UIã¯ãã®ã¾ã¾ã€Trackæ©Ÿæ§‹ã¯æ®µéšçš„æ‹¡å¼µå¯èƒ½
- ä»Šå¾Œæ‹¡å¼µäºˆå®š:
  1. Trackã”ã¨ã®ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ (AnalyserNode) è¡¨ç¤º
  2. Trackè¿½åŠ /å‰Šé™¤UIï¼ˆFaustè¤‡æ•°ãƒ­ãƒ¼ãƒ‰, Virtual / Sample Track ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ï¼‰
  3. ParamRegistry å°å…¥ã«ã‚ˆã‚‹ Faust Param UI åˆ†é›¢
  4. LogicInput / MicTrack äºŒé‡æ§‹é€ ã®çµ±åˆãƒãƒªã‚·ãƒ¼ç­–å®šï¼ˆè«–ç†Inputâ†’Trackç”Ÿæˆ or Trackã‚¿ã‚°ä»˜ã‘ï¼‰
  5. Effects Bus å®Ÿè£… & TrackListä¸Šã§ã®Busç¨®åˆ¥è¡¨ç¤ºï¼ˆkindãƒãƒƒã‚¸ï¼‰
  6. TrackçŠ¶æ…‹æ°¸ç¶šåŒ–ï¼ˆvolume/mute/soloï¼‰ã‚’ ProjectState ä¿å­˜ã«çµ„è¾¼ã¿
- ç•™æ„ç‚¹: ç¾çŠ¶ userVolume ã‚’ç›´æ¥GainNodeã§é©ç”¨ã€å¾Œæ®µã§ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³/ãƒ•ã‚§ãƒ¼ãƒ‰å°å…¥æ™‚ã¯ AudioParam ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã¸ç§»è¡Œ

### 2025-08-10 è¿½è¨˜: Trackãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿(MVP) å®Ÿè£…
- è¿½åŠ : `tracks.ts` ã« analyser + getTrackLevels() / lastLevel
- è¿½åŠ : `controller.ts` TrackListè¡Œã¸ãƒ¡ãƒ¼ã‚¿ãƒãƒ¼ (rAFæ›´æ–°, RMSâ†’ç°¡æ˜“ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³)
- è¨­è¨ˆ: volumeGain ã‚’ tap ã— analyser å‡ºåŠ›æœªæ¥ç¶š (ã‚³ã‚¹ãƒˆä½) / smoothing=0.7
- ã‚«ãƒ©ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«: <0.6 ç·‘ / 0.6â€“0.85 é»„ / >0.85 èµ¤ (ç°¡æ˜“ã‚¯ãƒªãƒƒãƒ—æŒ‡æ¨™)
- ä»Šå¾Œæ‹¡å¼µ: peakä¿æŒãƒ»dBè¡¨ç¤ºãƒ»ãƒ¡ãƒ¼ã‚¿æ›´æ–°ãƒ‘ãƒãƒ«æŠ˜ã‚Šç•³ã¿æœ€é©åŒ–
- æ¬¡å€™è£œ: EffectsBus éª¨çµ„ or LogicInputâ†”Track trackId åŒæœŸå¼·åŒ–

### 2025-08-10 è¿½è¨˜: EffectsBus éª¨çµ„ã¿å°å…¥
- `busManager.ts` ã« insertEffectsChain([])/clearEffectsChain() å®Ÿè£…
- åˆæœŸçŠ¶æ…‹: effectsBus ã¯ destination ã«ç›´çµï¼ˆãƒã‚¤ãƒ‘ã‚¹ï¼‰
- è¿½åŠ ãƒã‚§ãƒ¼ãƒ³: effectsBus -> node1 -> node2 -> ... -> destination å†æ§‹ç¯‰å‡¦ç†
- ä»Šå¾Œ: UI ã‹ã‚‰ãƒãƒ¼ãƒ‰è¿½åŠ ãƒ»é †åºå¤‰æ›´ / ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰å·®ã—æ›¿ãˆ / ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜
- TODO: ãƒã‚§ãƒ¼ãƒ³å·®ã—æ›¿ãˆæ™‚ã®ãƒãƒƒãƒ—å›é¿ (çŸ­ã„ãƒ•ã‚§ãƒ¼ãƒ‰), ParamRegistryçµ±åˆ

### 2025-08-10 è¿½è¨˜: UIå†é…ç½® & Trackæ“ä½œæ€§æ”¹å–„
- å¤‰æ›´: Logic Input / Routing ãƒ‘ãƒãƒ«ã‚’å³ä¸Šã¸ç§»å‹• (å›ºå®šå¹…/ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ, ãƒ‡ãƒã‚¤ã‚¹è¡¨ç¤ºçµ±åˆ)
- å¤‰æ›´: TrackList ã‚’å³ä¸‹ã¸ç§»å‹• (å¹…340px, max-height 40vh, ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«)
- æ”¹è‰¯: Trackè¡Œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ grid åŒ– (Name / Meter / Mute / Solo / Volume)
- è¿½åŠ : dBè¡¨ç¤ºãƒŸãƒ‹ãƒ©ãƒ™ãƒ« (-âˆ è¡¨ç¤º, 20*log10, smoothingç¶™æ‰¿)
- æ”¹è‰¯: Volumeã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ ãƒ›ã‚¤ãƒ¼ãƒ«æ“ä½œå¯¾å¿œ (Â±0.01 step), æ•°å€¤%è¡¨ç¤º
- ã‚¹ã‚¿ã‚¤ãƒ«: ãƒ©ã‚¤ãƒˆæ ãƒ»å½±ãƒ»è§’ä¸¸ã§è¦–èªæ€§å‘ä¸Š
- æ¬¡: LogicInput â†” Track ååŒæœŸ / EffectsChain UI ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—

# å®Ÿè£…æ–¹é‡ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— (Draft)

> **æ³¨æ„**
> ã“ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€Œã¾ãšè‡ªåˆ†ã®ä½œå“ï¼ˆãƒ©ã‚¤ãƒ–ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ç­‰ï¼‰ã‚’ä½œã‚‹ã€â†’ã€Œå¾Œã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚„é…å¸ƒç”¨ã«â€œç©ºâ€ã®çŠ¶æ…‹ã«ã™ã‚‹ã€ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
> ãã®ãŸã‚ã€**ä½œå“å›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚„UIã¯å¿…ãšã€Œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ã‚„ã€Œè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ã¨ã—ã¦åˆ†é›¢**ã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–æ™‚ã«ç°¡å˜ã«é™¤å¤–ãƒ»åˆ‡ã‚Šæ›¿ãˆã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
> ä»Šå¾ŒAIãŒè‡ªå‹•å®Ÿè£…ã™ã‚‹éš›ã‚‚ã€ã“ã®æ–¹é‡ã«å¾“ã„ã€Œä½œå“ç”¨ã€ã¨ã€Œæ±ç”¨éƒ¨ã€ã‚’æ˜ç¢ºã«åˆ†ã‘ã¦å®Ÿè£…ã—ã¾ã™ã€‚



## ç›®çš„
å˜ä¸€ `window.faustNode` / æ‰‹ç¶šãçš„ UI ã‹ã‚‰ã€è¤‡æ•°ãƒˆãƒ©ãƒƒã‚¯ãƒ»è¤‡æ•°DSPãƒ»æ‹¡å¼µå¯èƒ½ãªã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³/ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°/ä¿å­˜æ©Ÿæ§‹ã¸æ¼¸é€²çš„ã«ç§»è¡Œã™ã‚‹ã€‚

ã¾ãŸã€Faustä»¥å¤–ã®ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆä¾‹ï¼šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å…¥åŠ›ã‚„ç‹¬è‡ªã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã€MIDIãƒ»ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ãƒ»Web APIé€£æºãªã©ï¼‰ã‚‚ã€åŒã˜ä»•çµ„ã¿ã®ä¸­ã§è‡ªç„¶ã«æ‹¡å¼µãƒ»çµ±åˆã§ãã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚
ã•ã‚‰ã«ã€**ç«‹ä½“éŸ³éŸ¿ã‚„è¤‡æ•°ãƒã‚¤ã‚­ãƒ³ã‚°ã€è¤‡æ•°å‡ºåŠ›ï¼ˆä¾‹ï¼šãƒãƒ«ãƒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼/ãƒãƒ«ãƒãƒã‚¤ã‚¯ï¼‰**ãªã©ã€å…¥å‡ºåŠ›ãŒç‹¬ç«‹ã—ãŸè¤‡æ•°ãƒˆãƒ©ãƒƒã‚¯ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ã«ã‚‚æŸ”è»Ÿã«å¯¾å¿œã§ãã‚‹ã‚ˆã†ã€ã‚¨ãƒ³ã‚¸ãƒ³ONå¾Œã«å„å…¥å‡ºåŠ›ã‚’Microphone Routing UIã‹ã‚‰è‡ªç”±ã«ã‚¢ã‚µã‚¤ãƒ³ãƒ»ãƒ†ã‚¹ãƒˆã§ãã‚‹ä»•çµ„ã¿ã‚’æ—©æœŸã«å°å…¥ã—ã¾ã™ã€‚
ä½œå“ç”¨ã®Track/Param/ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°/å¤–éƒ¨é€£æºãªã©ã¯ã€Œåˆ†é›¢ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»è¨­å®šã€ã¨ã—ã¦ç®¡ç†ã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–æ™‚ã«å®¹æ˜“ã«â€œç©ºâ€ã«ã§ãã‚‹è¨­è¨ˆã‚’å¾¹åº•ã—ã¾ã™ã€‚

---

## å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å±¤



## é€²æ—è¨˜éŒ²ãƒ»é‹ç”¨æ–¹é‡

ä»Šå¾Œã“ã® `IMPLEMENTATION_PLAN.md` ã«æ²¿ã£ã¦ä½œæ¥­ã‚’é€²ã‚ã‚‹éš›ã¯ã€ã©ã“ã¾ã§é€²ã‚“ã ã‹ãƒ»ã©ã®ã‚ˆã†ãªå®Ÿè£…/ä¿®æ­£ã‚’è¡Œã£ãŸã‹ãƒ»æ¬¡ã«ã‚„ã‚‹ã¹ãã“ã¨ç­‰ã‚’å¿…ãšè¨˜éŒ²ãƒ»è¿½è¨˜ã—ã¦ãã ã•ã„ã€‚

### æ¨å¥¨é‹ç”¨
- æœ¬ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«ã€Œé€²æ—ãƒ­ã‚°ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ–°è¨­ã—ã€æ—¥ä»˜ãƒ»å†…å®¹ãƒ»æ‹…å½“ãƒ»æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç­‰ã‚’æ™‚ç³»åˆ—ã§è¿½è¨˜ã™ã‚‹
  - ä¾‹: `## é€²æ—ãƒ­ã‚°` ã®ä¸‹ã«æ—¥ä»˜ã”ã¨ã«è¨˜éŒ²
- ã‚‚ã—ãã¯ `PROGRESS_LOG.md` ãªã©åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ãã¡ã‚‰ã«é€²æ—ã‚’ã¾ã¨ã‚ã‚‹

ã©ã¡ã‚‰ã®å ´åˆã‚‚ã€
  - æ—¥ä»˜
  - å®Ÿæ–½å†…å®¹ï¼ˆã©ã®ã‚¹ãƒ†ãƒƒãƒ—ãƒ»ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã©ã†å¤‰æ›´ã—ãŸã‹ï¼‰
  - æ°—ã¥ããƒ»èª²é¡Œãƒ»TODO
  - æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
ã‚’ç°¡æ½”ã«æ®‹ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€å¾Œã‹ã‚‰è¦‹è¿”ã—ãŸéš›ã«é€²æ—ã‚„è¨­è¨ˆæ„å›³ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚
2. Track Layer: Track + DSPChain ç®¡ç†ï¼ˆ`audio/tracks.ts`ï¼‰
3. Source Layer: Mic / FaustSynth / Sample ç”Ÿæˆãƒ•ã‚¡ã‚¯ãƒˆãƒªï¼ˆ`audio/sources/*`ï¼‰
4. DSP Layer: Faustãƒ­ãƒ¼ãƒ‰æŠ½è±¡ï¼ˆ`audio/dsp/faustLoader.ts`ï¼‰
5. Routing Layer: Sourceâ†’Bus æ¥ç¶šï¼ˆåˆæœŸã¯ Masterå›ºå®š â†’ `audio/routing/routingMatrix.ts`ï¼‰
6. Param Registry: DSPãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ—æŒ™ãƒ»è¨­å®šAPIï¼ˆ`audio/params/paramRegistry.ts`ï¼‰
7. Transport / Schedulerï¼ˆå¿…è¦æ®µéšã§å°å…¥ï¼‰: å†ç”Ÿä½ç½®ãƒ»Clip/Automationã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆ`audio/transport/transport.ts`ï¼‰
8. Persistence: ProjectState JSON dump/loadï¼ˆ`audio/project/state.ts`ï¼‰
9. Event Bus: UIåŒæœŸã® pub/subï¼ˆè–„ã„ `EventTarget`ï¼‰

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¡ˆ
```
src/audio/
  audioCore.ts
  tracks.ts
  routing/routingMatrix.ts
  dsp/faustLoader.ts
  sources/micSource.ts
  sources/faustSource.ts
  sources/sampleSource.ts
  params/paramRegistry.ts
  transport/transport.ts (å¾Œ)
  project/state.ts (å¾Œ)
```

---


## ã‚³ã‚¢æŠ½è±¡ï¼ˆæœ€å°å½¢ï¼‰
```ts
// TrackKindã¯ä»Šå¾Œã‚‚æ‹¡å¼µå¯èƒ½ï¼ˆä¾‹: 'controller', 'midi', 'custom' ãªã©ï¼‰
type TrackKind = 'mic' | 'faust' | 'sample' | 'bus' | 'controller' | 'midi' | 'custom';

interface DSPUnit {
  id: string;
  node: AudioNode;
  getParamJSON?(): Promise<any>;
  setParam?(addr:string,v:number): void;
}

interface Track {
  id: string;
  name: string;
  kind: TrackKind;
  inputNode: AudioNode;
  volumeGain: GainNode;
  outputNode: AudioNode; // = volumeGain
  dspChain: DSPUnit[];
  muted: boolean;
  solo: boolean;
  // å¿…è¦ã«å¿œã˜ã¦å¤–éƒ¨å…¥åŠ›ã‚„ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¨ã®ç´ä»˜ã‘æƒ…å ±ã‚‚è¿½åŠ å¯èƒ½
}

interface RoutingAssignment { sourceId: string; busId: string; gain: number; enabled: boolean; }
```

### Faustä»¥å¤–ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚„å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã®æ‹¡å¼µä¾‹
- TrackKindã«'controller'ã‚„'midi'ãªã©ã‚’è¿½åŠ ã—ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å…¥åŠ›ã‚„MIDIã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒ©ãƒƒã‚¯ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åæ˜ ã§ãã‚‹
- ParamRegistryã‚„EventBusã‚’é€šã˜ã¦ã€å¤–éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆã‹ã‚‰ä»»æ„ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ãƒˆãƒ©ãƒƒã‚¯ã‚’æ“ä½œã§ãã‚‹
- ä¾‹: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ãƒãƒ–æ“ä½œã§ç‰¹å®šTrackã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‹•ã‹ã™ã€MIDIãƒãƒ¼ãƒˆã§SampleTrackã‚’ãƒˆãƒªã‚¬ã™ã‚‹ ãªã©

---

## UI åˆ†å‰²æ–¹é‡
| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | å½¹å‰² |
| --- | --- |
| `bootstrap.ts` | DOMContentLoaded â†’ åˆæœŸåŒ–å‘¼ã³å‡ºã— |
| `ui/trackList.ts` | Trackåˆ—è¡¨ç¤ºãƒ»è¿½åŠ ãƒ»mute/solo/volume |
| `ui/paramPanel.ts` | Tracké¸æŠ + DSPé¸æŠ + Paramç”Ÿæˆ |
| `ui/micPanel.ts` | ç¾ mic routing UI ã‚’æ®µéšç§»è¡Œ |
| `ui/transportBar.ts` | å†ç”Ÿ/åœæ­¢/ä½ç½®/ãƒ«ãƒ¼ãƒ— (å¾Œ) |
| `ui/visualizerControls.ts` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ“ä½œåˆ†é›¢ |
| `ui/projectMenu.ts` | Save/Load |

æš«å®š `window.audioAPI` ã«çµ±ä¸€ã‚¢ã‚¯ã‚»ã‚¹ãƒã‚¤ãƒ³ãƒˆ:
```ts
window.audioAPI = {
  listTracks, createFaustTrack, createMicTrack,
  getTrackParams, setParam, attachFaust, saveProject, loadProject
};
```

---



## æ®µéšçš„å°å…¥ã‚¹ãƒ†ãƒƒãƒ—

---
#### ã€2025-08-10 è¿½è¨˜ã€‘ãƒã‚¤ã‚¯æœªæ¥ç¶šæ™‚ã®MicTrackæœ‰åŠ¹åŒ–äºˆç´„ãƒ»ä»®æƒ³ãƒˆãƒ©ãƒƒã‚¯ã«ã¤ã„ã¦

ç¾çŠ¶ã®Step2ã§ã¯ã€Œç‰©ç†ãƒã‚¤ã‚¯ãŒæœªæ¥ç¶šã®å ´åˆã¯MicTrackã‚‚ç”Ÿæˆã•ã‚Œãªã„ã€è¨­è¨ˆãŒåŸºæœ¬ã§ã™ã€‚
ã€Œãƒã‚¤ã‚¯ãŒæœªæ¥ç¶šã§ã‚‚MicTrackã‚’ä»®æƒ³çš„ã«ä½œæˆã—ã€å¾Œã‹ã‚‰ç‰©ç†ãƒã‚¤ã‚¯ãŒç¹‹ãŒã£ãŸã‚‰è‡ªå‹•ã§æœ‰åŠ¹åŒ–ã€ã‚„ã€
ã€ŒUIä¸Šã§MicTrackã®æœ‰åŠ¹åŒ–ã‚’â€œäºˆç´„â€ã§ãã‚‹ã€ä»•çµ„ã¿ã¯ã€Step3ï¼ˆè¤‡æ•°å…¥å‡ºåŠ›ãƒˆãƒ©ãƒƒã‚¯ã®ã‚¢ã‚µã‚¤ãƒ³UIãƒ»å…¥å‡ºåŠ›ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®å°å…¥ï¼‰ã‚„ã€
ã•ã‚‰ã«å¾Œã®æ‹¡å¼µã§æ‰±ã†ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

ã‚‚ã—Step2ã®æ®µéšã§â€œä»®æƒ³MicTrackâ€ã‚„â€œæœ‰åŠ¹åŒ–äºˆç´„â€ã‚‚æ‰±ã„ãŸã„å ´åˆã¯ã€è¨­è¨ˆãƒ»å®Ÿè£…æ–¹é‡ã®è¿½åŠ æ¤œè¨ãŒå¿…è¦ã§ã™ã€‚
---
| Step | ç›®çš„ | å½±éŸ¿ç¯„å›² |
| ---- | ---- | -------- |
| 1 | `tracks.ts` å°å…¥ï¼æ—¢å­˜ Faust ã‚’ Track åŒ–ï¼`window.faustNode` äº’æ›ç¶­æŒ | è¿½åŠ ã®ã¿ |
| 2 | Mic æœ‰åŠ¹åŒ–ã§ MicTrack ä½œæˆï¼ãƒ¡ãƒ¼ã‚¿æ¥ç¶šã‚’ Track ãƒ™ãƒ¼ã‚¹åŒ– | InputManager å¾®ä¿®æ­£ |
| 3 | **è¤‡æ•°å…¥å‡ºåŠ›ãƒˆãƒ©ãƒƒã‚¯ã®ã‚¢ã‚µã‚¤ãƒ³UIï¼ˆMicrophone Routingæ‹¡å¼µï¼‰ã¨å…¥å‡ºåŠ›ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®å°å…¥**<br>ï¼ˆç«‹ä½“éŸ³éŸ¿ãƒ»è¤‡æ•°ãƒã‚¤ã‚­ãƒ³ã‚°ãƒ»ãƒãƒ«ãƒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ç­‰ã«å¯¾å¿œã€‚ã‚¨ãƒ³ã‚¸ãƒ³ONå¾Œã«å„å…¥å‡ºåŠ›ã‚’è‡ªç”±ã«ã‚¢ã‚µã‚¤ãƒ³ãƒ»ãƒ†ã‚¹ãƒˆã§ãã‚‹ï¼‰ | Routing/UI/InputManageræ‹¡å¼µ |
| 4 | Faustä»¥å¤–ã®å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å…¥åŠ›ãƒ»MIDIãƒ»Web APIç­‰ï¼‰ã‚’Track/ParamRegistry/EventBusçµŒç”±ã§æ‰±ãˆã‚‹åœŸå°ã‚’ç”¨æ„ | TrackKindæ‹¡å¼µãƒ»APIè¿½åŠ  |
| 5 | è¤‡æ•° Faust DSP ãƒ­ãƒ¼ãƒ‰ API (`attachFaust`) | æ–°UIæº–å‚™ |
| 6 | ParamRegistry è¿½åŠ  â†’ æ—¢å­˜è‡ªå‹•ç”ŸæˆUIå†…éƒ¨ç½®æ› | `renderFaustParams` |
| 7 | TrackList UIï¼ˆmute/solo/volumeï¼‰å°å…¥ | æ–°UIè¿½åŠ  |
| 8 | RoutingMatrix éª¨çµ„ï¼ˆç¾çŠ¶ master ã®ã¿ï¼‰â†’ å°†æ¥ Aux æ‹¡å¼µ | éŸ³å£°å†é…ç·šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ |
| 9 | Transportï¼ˆplay/pause/positionï¼‰ + SampleClip MVP | æ–°ãƒ•ã‚¡ã‚¤ãƒ« |
| 10 | AutomationPointï¼ˆParamå¤‰åŒ–ï¼‰ | Scheduler æ‹¡å¼µ |
| 11 | ProjectState ä¿å­˜/å¾©å…ƒ | JSON I/O |
| 12 | Aux Bus / Send / Sidechain / Scene | å¾ŒæœŸ |

---

## Transport / Timeline (å¾ŒåŠ)
MVP: ç§’ãƒ™ãƒ¼ã‚¹ `Transport` + lookAhead scheduler(0.2s / 50ms tick)  
å¾Œ: TempoMap, Beatå¤‰æ›, Automationè£œé–“, Clipç·¨é›†ã€‚

---

## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†
- åˆå› getJSON â†’ æ­£è¦åŒ– â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- UIã¯ Track + DSPé¸æŠã§ãƒ•ã‚£ãƒ«ã‚¿
- Set: `paramRegistry.set(trackId,dspIndex,address,value)`
- Automationå¯¾å¿œæ™‚: scheduler ãŒ paramRegistry çµŒç”±ã§ apply (AudioParamãªã‚‰ `setValueAtTime`)

---

## Routing æˆ¦ç•¥ï¼ˆæ®µéšï¼‰
1. å›ºå®š: Track.output â†’ masterGain
2. Matrix: assignments[] ã‚’å†æ§‹ç¯‰æ™‚ã«ãƒ•ã‚§ãƒ¼ãƒ‰ï¼ˆ5â€“10msï¼‰ã§ disconnect/connect
3. Aux: Sendç”¨ GainNode ã‚’ Trackæ¯ç”Ÿæˆ â†’ BusTrack.input ã«è¤‡æ•°æ¥ç¶š
4. Sidechain: ControlBus (Analyser/EnvelopeFollower) ã‹ã‚‰ ParamDrive

---

## ä¿å­˜å½¢å¼ (ä¾‹)
```json
{
  "version": 1,
  "tracks": [
    { "id": "synth1", "kind": "faust", "dsp": [{ "type": "faust", "path": "/dsp/mysynth.dsp", "params": {...}}], "volume":1, "mute":false }
  ],
  "routing": [{ "sourceId":"synth1", "busId":"master", "gain":1, "enabled":true }],
  "clips": [],
  "automation": []
}
```

---

## ãƒªã‚¹ã‚¯ & å›é¿
| ãƒªã‚¹ã‚¯ | å›é¿ç­– |
| ------ | ------ |
| è¤‡æ•°FauståˆæœŸåŒ–é…å»¶ | é…å»¶ãƒ­ãƒ¼ãƒ‰ãƒ»åŒä¸€hashã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| å†é…ç·šãƒãƒƒãƒ—ãƒã‚¤ã‚º | Gainãƒ•ã‚§ãƒ¼ãƒ‰ (setValueAtTime) |
| UIè‚¥å¤§ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹ | requestAnimationFrame ãƒãƒƒãƒï¼éè¡¨ç¤ºåœæ­¢ |
| äº’æ›å´©å£Š | `window.faustNode` æ®µéšçš„æ’¤å»è¨ˆç”» |
| Stateä¸æ•´åˆ | EventBus 1å‡ºæ‰€ (Trackè¿½åŠ /å‰Šé™¤/paramå¤‰æ›´) |

---

## æœ€åˆã®å…·ä½“ã‚¿ã‚¹ã‚¯ï¼ˆæ¨å¥¨é †ï¼‰
1. `src/audio/tracks.ts` è¿½åŠ  + `createTrackEnvironment` å®Ÿè£…
2. controller.ts ã® initAudio å®Œäº†æ™‚ã« Track åŒ…è£…
3. `window.audioAPI.listTracks()` ã‚’ç¢ºèª
4. Mic æœ‰åŠ¹åŒ–æ™‚ã« MicTrack ç”Ÿæˆï¼ˆå‡ºåŠ›ã¯ masterï¼‰
5. ParamRegistry ä¸‹æ›¸ãï¼ˆä»Šã¯é€é delegatesï¼‰
6. TrackList UI æœ€å°ï¼ˆåˆ—æŒ™ï¼‹volumeï¼‰

---

## ä»¥é™ã®æ‹¡å¼µãƒˆãƒªã‚¬
- ã‚µãƒ³ãƒ—ãƒ«å†ç”Ÿè¦ä»¶æˆç«‹ â†’ Transport/Clips é–‹å§‹
- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒã‚§ãƒ¼ãƒ³å·®æ›¿é »ç™º â†’ DSPãƒ›ãƒƒãƒˆã‚¹ãƒ¯ãƒƒãƒ—ï¼ˆæ—§/æ–°ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ï¼‰
- å¤–éƒ¨ä¿å­˜ãƒ‹ãƒ¼ã‚º â†’ ProjectState å…ˆè¡Œ

---

## æˆåŠŸæ¡ä»¶ (çŸ­æœŸ)
- æ—¢å­˜UIå£Šã•ãšè¤‡æ•° Faust Track è¿½åŠ ãŒå¯èƒ½
- MicTrack ãŒ TrackList ã«ç¾ã‚Œ volume/mute åæ˜ 
- ParamUI ãŒ Trackåˆ‡æ›¿ã§ãã‚‹ï¼ˆå°†æ¥ï¼‰

## æˆåŠŸæ¡ä»¶ (ä¸­æœŸ)
- RoutingMatrix ã§ ON/OFF / Gain å¤‰æ›´å³åæ˜ 
- å†ç”Ÿ/åœæ­¢ + SampleClip ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å‹•ä½œ
- ä¿å­˜/å¾©å…ƒã§åŒã˜éŸ³æ§‹æˆãŒå†ç¾

---

## ã¾ã¨ã‚
ã“ã®è¨­è¨ˆã§ã¯ã€Faustã ã‘ã§ãªãã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å…¥åŠ›ã‚„MIDIã€Web APIãªã©ã€Œå¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã€ã‚‚Track/ParamRegistry/EventBusã®æŠ½è±¡ã‚’é€šã˜ã¦æŸ”è»Ÿã«çµ±åˆã§ãã¾ã™ã€‚
å°è¦æ¨¡ã‚¹ãƒ†ãƒƒãƒ—ã§ Track/DSP/Routing/Param ã‚’åˆ†é›¢ã—ã€äº’æ›ãƒ¬ã‚¤ãƒ¤ã‚’æ®‹ã—ã¤ã¤å¾ã€…ã« UI ã¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’è§£è€¦ã€‚å¾Œæ®µã§ Transport/Automation ã‚„å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚‚è‡ªç„¶è¿½åŠ ã€‚

ã¾ãŸã€å°†æ¥çš„ã«ã¯Max/MSPã®ã‚ˆã†ãªã€Œãƒãƒ¼ãƒ‰ï¼ˆTrack/DSP/Bus/Paramï¼‰ã‚’ç·šã§ã¤ãªãã€ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¨ãƒ‡ã‚£ã‚¿ã‚„ã€
ä¿¡å·ãƒ•ãƒ­ãƒ¼ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ã«å¯è¦–åŒ–ãƒ»ç·¨é›†ã§ãã‚‹UIã‚‚ç›®æŒ‡ã—ã¾ã™ã€‚
Faustã®è‡ªå‹•ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½ã‚„ã€å…¨ä½“æ§‹æˆã®ãƒ†ã‚­ã‚¹ãƒˆè¨˜è¿°ã¨ã®é€£æºã‚‚æ„è­˜ã—ã€
ã€Œç›´æ„Ÿçš„ã§ç¾ã—ã„ãƒ‘ãƒƒãƒãƒ³ã‚°ä½“é¨“ã€ã‚’æä¾›ã§ãã‚‹ã‚ˆã†æ‹¡å¼µã—ã¦ã„ãã¾ã™ã€‚

### DSPåˆ†é¡ã‚·ã‚¹ãƒ†ãƒ  (å°†æ¥æ‹¡å¼µ)
- **ç›®çš„**: Synthã‚«ãƒ†ã‚´ãƒªã€Effectã‚«ãƒ†ã‚´ãƒªã€ãŠã‚ˆã³ãã®å¢ƒç•ŒãŒæ›–æ˜§ãªDSPã‚’é©åˆ‡ã«ç®¡ç†ãƒ»é…ç½®ã™ã‚‹ä½“ç³»ã®ç¢ºç«‹ã€‚
- **åˆ†é¡æ–¹é‡**:
  - **Sourceç³»**: éŸ³æºç”Ÿæˆï¼ˆoscillator, sampler, noise generatorç­‰ï¼‰- æ–°Trackä½œæˆã«é©ç”¨
  - **Effectç³»**: éŸ³éŸ¿å‡¦ç†ï¼ˆreverb, filter, compressorç­‰ï¼‰- æ—¢å­˜Track Insert/Sendé…ç½®
  - **Hybridç³»**: éŸ³æº+ã‚¨ãƒ•ã‚§ã‚¯ãƒˆèåˆï¼ˆgranular reverb, vocoder, self-oscillating filterç­‰ï¼‰- ç”¨é€”ã«å¿œã˜ã¦æŸ”è»Ÿé…ç½®
  - **Utilityç³»**: åˆ†æãƒ»åˆ¶å¾¡ï¼ˆanalyzer, envelope follower, sequencerç­‰ï¼‰- åˆ¶å¾¡ä¿¡å·ç”Ÿæˆ
- **Tracké…ç½®ãƒ«ãƒ¼ãƒ«**:
  ```typescript
  interface DSPCompatibility {
    canBeSource: boolean;     // æ–°Trackå˜ç‹¬é…ç½®å¯èƒ½
    canBeInsert: boolean;     // Insert chainé…ç½®å¯èƒ½  
    canBeSend: boolean;       // Send/Returné…ç½®å¯èƒ½
    requiresInput: boolean;   // å…¥åŠ›éŸ³å£°å¿…é ˆ
  }
  ```
- **UIå‹•ä½œ**: DSPè¿½åŠ æ™‚ã«åˆ†é¡ã«åŸºã¥ã„ã¦é…ç½®é¸æŠè‚¢ã‚’è‡ªå‹•æç¤º
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾**: ã‚«ãƒ†ã‚´ãƒªåˆ¥è‰²åˆ†ã‘ï¼ˆSource:ç·‘, Effect:é’, Hybrid:ç´«, Utility:ç°ï¼‰ã§ãƒãƒ¼ãƒ‰è­˜åˆ¥
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: public/dsp/ ä¸‹ã®.dspãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾å¿œã™ã‚‹.jsonã§ã‚«ãƒ†ã‚´ãƒªæƒ…å ±ç®¡ç†
- **å®Ÿè£…æ®µéš**: EffectRegistryæ‹¡å¼µæ™‚ã«category/subCategoryãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ ã€UIå´ã§é…ç½®ãƒ­ã‚¸ãƒƒã‚¯åˆ†å²

### Trackç”Ÿæˆãƒ»ç ´æ£„ãƒ»ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºå¯¾ç­– (é‡è¦)
- **Synthç³»DSP Trackç®¡ç†**: DSPæœ‰åŠ¹åŒ–æ™‚ã«Trackè‡ªå‹•ç”Ÿæˆã€ç„¡åŠ¹åŒ–æ™‚ã«å®‰å…¨ç ´æ£„
- **æŸ”è»ŸãªTrackç”Ÿæˆã‚¿ã‚¤ãƒŸãƒ³ã‚°**: 
  - å³åº§ç”Ÿæˆï¼ˆUIæ“ä½œæ™‚ï¼‰
  - é…å»¶ç”Ÿæˆï¼ˆæ¡ä»¶å¾…ã¡ï¼šãƒ‡ãƒã‚¤ã‚¹æ¥ç¶šã€ãƒ—ãƒªã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ç­‰ï¼‰  
  - ä¸€æ‹¬ç”Ÿæˆï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¾©å…ƒæ™‚ï¼‰
- **ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºå›é¿æ©Ÿæ§‹**:
  ```typescript
  // Trackç”Ÿæˆæ™‚ã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³
  async createTrackSafely(config: TrackConfig): Promise<Track> {
    const track = createTrack(config);
    track.volumeGain.gain.setValueAtTime(0, audioContext.currentTime);
    track.volumeGain.gain.linearRampToValueAtTime(
      config.initialVolume, audioContext.currentTime + 0.015
    );
    return track;
  }
  
  // Trackç ´æ£„æ™‚ã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
  async dismissTrackSafely(track: Track): Promise<void> {
    const fadeTime = 0.02; // 20ms
    track.volumeGain.gain.linearRampToValueAtTime(
      0, audioContext.currentTime + fadeTime
    );
    setTimeout(() => {
      track.dispose(); // æ¥ç¶šè§£é™¤ãƒ»ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
      removeFromTrackList(track.id);
    }, fadeTime * 1000 + 10); // ä½™è£•ã‚’ã‚‚ã£ã¦ç ´æ£„
  }
  ```
- **çŠ¶æ…‹ç®¡ç†**: LogicInput â†” Track é–¢é€£ä»˜ã‘ã®å‹•çš„æ›´æ–°ã€persistence v3ã§ã®çŠ¶æ…‹ä¿æŒ
- **UIåæ˜ **: TrackListä¸Šã§ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºç¾ãƒ»æ¶ˆå¤±ã€ãƒ¡ãƒ¼ã‚¿çŠ¶æ…‹ã®ã‚¹ãƒ ãƒ¼ã‚ºé·ç§»

## ğŸš€ æ¬¡æœŸå®Ÿè£…å„ªå…ˆé †ä½ (2025-08-18 æ›´æ–°)

### **ğŸ¯ ç¾åœ¨ã®çŠ¶æ³**
- âœ… **Base Audioåˆ†é›¢å®Ÿè£…**: `ensureBaseAudio()` + `applyFaustDSP()` å®Œäº†
- âœ… **TestSignalManager**: tone/noise/impulse ãƒ†ã‚¹ãƒˆä¿¡å·ã‚·ã‚¹ãƒ†ãƒ å®Œæˆ
- âœ… **Faust DSPéŸ³éŸ¿å•é¡Œ**: éŸ³å£°å‡ºåŠ›ãƒ»å®‰å®šæ€§å•é¡Œå®Œå…¨è§£æ±º
- âœ… **AudioContextç®¡ç†**: keep-aliveæ©Ÿæ§‹ã€å‚ç…§ä¿æŒã€è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…æ¸ˆã¿
- âœ… **TrackåŸºç¤ã‚·ã‚¹ãƒ†ãƒ **: mute/solo/volumeã€ãƒ¡ãƒ¼ã‚¿è¡¨ç¤ºã€æ°¸ç¶šåŒ–v1å¯¾å¿œæ¸ˆã¿
- âœ… **Effects Chain GUI**: Master FXãƒã‚§ãƒ¼ãƒ³è¿½åŠ ãƒ»å‰Šé™¤ãƒ»é †åºå¤‰æ›´ãƒ»ãƒã‚¤ãƒ‘ã‚¹æ©Ÿèƒ½å®Ÿè£…æ¸ˆã¿
- âœ… **EffectRegistry v2**: ã‚«ãƒ†ã‚´ãƒªåˆ†é¡ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ã€busManagerçµ±åˆå®Œäº†

### **Phase 1: å®Ÿéš›ã®Faust WASMçµ±åˆ (æœ€é«˜å„ªå…ˆ)**
1. **mysynth.dsp WASMåŒ–**
   - ç¾åœ¨ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã®GainNodeã‚’å®Ÿéš›ã®Faust AudioWorkletNodeã«ç½®æ›
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªå‹•ãƒãƒƒãƒ”ãƒ³ã‚°
   - DSPâ†’WASMâ†’AudioWorkletNodeç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè£…

2. **ãƒ—ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«Faustå¯¾å¿œ**
   - äº‹å‰ãƒ“ãƒ«ãƒ‰WASMãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•æ¤œå‡ºãƒ»ãƒ­ãƒ¼ãƒ‰
   - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿DSPã®é«˜é€Ÿã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æƒ…å ±ã®è‡ªå‹•æŠ½å‡º

### **Phase 2: Track Lifecycle Manager å®Ÿè£…**
1. **å®‰å…¨ãªTrackç”Ÿæˆãƒ»ç ´æ£„ã‚·ã‚¹ãƒ†ãƒ **
   - 15ms ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã€20ms ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆå®Ÿè£…
   - LogicInput â†” Track å‹•çš„é€£æº
   - ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºå®Œå…¨æ’é™¤æ©Ÿæ§‹

2. **LogicInput & Track çµ±åˆ**
   - trackId ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
   - ç”Ÿæˆ/å‰Šé™¤ãƒ•ãƒ­ãƒ¼å®Ÿè£…
   - pendingçŠ¶æ…‹ç®¡ç†

### **Phase 3: UIæ‹¡å¼µãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š**
1. **ã‚¨ãƒ•ã‚§ã‚¯ãƒˆé¸æŠUIæ”¹å–„**
   - ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼
   - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆèª¬æ˜ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç·¨é›†UIçµ±åˆ

2. **Effects Chainè¡¨ç¤ºæ‹¡å¼µ**
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
   - Bypassè¦–è¦šåŒ–æ”¹å–„
   - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ä¸¦ã³æ›¿ãˆ

### **Phase 4: ProjectState v2 çµ±åˆ**
1. **çµ±ä¸€ä¿å­˜å½¢å¼å®Ÿè£…**
   - tracksState/v1 + logicInputs/v3 â†’ projectState/v2
   - Track.effectsChain + EffectRegistry v2å‚ç…§ã®æ°¸ç¶šåŒ–
   - Migration ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…

### **Phase 5: Insert/Send äºŒå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**
1. **Send/Aux Bus ã‚·ã‚¹ãƒ†ãƒ **
   - Track Insert Effects + Send Bus åˆ†é›¢
   - AuxBus å®Ÿè£…
   - ãƒ«ãƒ¼ãƒ—é˜²æ­¢ãƒã‚§ãƒƒã‚¯

---

### **ğŸ¯ å³åº§ã«é–‹å§‹ã™ã¹ãä½œæ¥­**

ç¾åœ¨ã®æœ€å„ªå…ˆã‚¿ã‚¹ã‚¯ã¯ **Phase 1: å®Ÿéš›ã®Faust WASMçµ±åˆ** ã§ã™ã€‚

#### **1. mysynth.dsp ã®å®ŸWASMåŒ–**
- ç¾åœ¨ã®EffectRegistry v2ã¯å®Ÿè£…å®Œäº†ã—ã¦ã„ã‚‹ãŒã€ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã®GainNodeã‚’ä½¿ç”¨
- mysynth.dspã‚’å®Ÿéš›ã®Faust AudioWorkletNodeã¨ã—ã¦å‹•ä½œã•ã›ã‚‹
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿(.json)ã¨DSPã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•é€£æº

#### **2. å®Ÿè£…æ¤œè¨¼**
- ãƒ–ãƒ©ã‚¦ã‚¶ã§EffectRegistry v2ã®ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³å‹•ä½œç¢ºèª
- DSPè‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ ãƒ»å‰Šé™¤ã®å®Ÿå‹•ä½œç¢ºèª

**æº–å‚™ãŒã§ãã¾ã—ãŸã‹ï¼ŸPhase 1ã®å®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ï¼**

### 2025-08-10 Step3 æº–å‚™: LogicInput ã¨ Track çµ±åˆæ–¹é‡ (Draft)
- ç¾çŠ¶èª²é¡Œ:
  - LogicInput(è«–ç†Inputç®¡ç† + ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°UI + persistence) ã¨ Track (mute/solo/volume + å°†æ¥Param/UI) ãŒä¸¦ç«‹ã—é‡è¤‡ã™ã‚‹è²¬å‹™ã‚ã‚Šã€‚
  - MicTrackç”Ÿæˆã¯ç‰©ç†ãƒã‚¤ã‚¯æœ‰åŠ¹åŒ–çµŒè·¯(InputManager)çµŒç”±ã€LogicInputå´ã§æœ‰åŠ¹åŒ–/ã‚¢ã‚µã‚¤ãƒ³ã—ã¦ã‚‚å³ Track åŒ–ã•ã‚Œãªã„ã‚¿ã‚¤ãƒ ãƒ©ã‚°/ä¸æ•´åˆã®ä½™åœ°ã€‚
- çµ±åˆã‚´ãƒ¼ãƒ«(æ®µéšçš„):
  1. LogicInput = Track ä½œæˆãƒˆãƒªã‚¬(ä¸€å¯¾ä¸€)ã€‚
  2. ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã‚¢ã‚µã‚¤ãƒ³å®Œäº† + enabled=true ã§ MicTrack (kind 'mic') è‡ªå‹•ç”Ÿæˆã€‚
  3. æœªã‚¢ã‚µã‚¤ãƒ³/disabled ã® LogicInput ã¯â€œpendingâ€çŠ¶æ…‹ (Trackæœªç”Ÿæˆ) ã¨ã—ã¦UIè¡¨ç¤ºã€‚
  4. LogicInput å‰Šé™¤ã§å¯¾å¿œã™ã‚‹ Track ã‚’å®‰å…¨ã«disposeã€‚
  5. TrackList å´ã§ name ç·¨é›† â†’ LogicInput.label ã¸åæ˜ (å˜ä¸€ã‚½ãƒ¼ã‚¹ã‚ªãƒ–ãƒˆã‚¥ãƒ«ãƒ¼ã‚¹ label)ã€‚
- é¸æŠã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:
  - Phase A: Trackã¯ç”Ÿæˆå¾Œ read-only (name/mute/solo/volumeã®ã¿)ã€‚ãƒ©ãƒ™ãƒ«ç·¨é›†ã¯ LogicInput å´â†’å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã€‚
  - Phase B: åŒæ–¹å‘åŒæœŸ (Trackåå¤‰æ›´â†’LogicInputæ›´æ–°) å®Ÿç¾ã€‚
- è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¡ˆ:
  - LogicInput: trackId?: string | null (ç”Ÿæˆæ¸ˆã¿ Track å‚ç…§)ã€‚
  - Track: originLogicInputId?: string (é€†å‚ç…§)ã€‚
- ãƒ¡ãƒ¼ã‚¿å°å…¥è¨ˆç”»:
  1. Track.volumeGain å¾Œæ®µã« AnalyserNode ã‚’æŒ¿å…¥ã€‚
  2. requestAnimationFrame ã§å…¨Trackãƒ¡ãƒ¼ã‚¿ã‚’1ãƒ«ãƒ¼ãƒ—é›†è¨ˆ â†’ TrackList UI ã«æç”»ã€‚
  3. éè¡¨ç¤ºæ™‚(ãƒ‘ãƒãƒ«æŠ˜ã‚ŠãŸãŸã¿äºˆå®š)ã¯è¨ˆæ¸¬åœæ­¢ã§CPUç¯€ç´„ã€‚
- Effects Bus å®Ÿè£…å‰å€’ã—ç†ç”±:
  - RoutingUI ã® synth/effects/monitor ãƒ•ãƒ©ã‚°ã‚’å®ŸéŸ³å£°ä¸Šã§å¯è¦–åŒ–ç¢ºèªã—ã‚„ã™ãã™ã‚‹ã€‚
  - BusManager ã« insertEffectsChain(trackId, nodes[]) å½¢ã®æ‹¡å¼µãƒ•ãƒƒã‚¯ã‚’è¿½åŠ äºˆå®šã€‚
- Persistence æ¬¡ãƒ•ã‚§ãƒ¼ã‚º:
  - logicInputs v1 æ—¢å­˜ â†’ v2 ã§ trackId, pending çŠ¶æ…‹, lastVolume è¿½åŠ ã€‚
  - Migration: v1 ãƒ­ãƒ¼ãƒ‰æ™‚ã¯æ¬ æãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè£œå®Œã€‚
- ç›´è¿‘ã‚¿ã‚¹ã‚¯ (å„ªå…ˆé †):
  1. LogicInput ã« trackId è¿½åŠ  & ç”Ÿæˆ/å‰Šé™¤ãƒ•ãƒ­ãƒ¼ (Phase A)ã€‚
  2. LogicInput enable / device assign ã‚¤ãƒ™ãƒ³ãƒˆã§ ensureTrack() å®Ÿè£…ã€‚
  3. Track dispose ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£è¿½åŠ  (tracks.ts)ã€‚
  4. TrackList ã«ãƒ¡ãƒ¼ã‚¿æ¬„(ç°¡æ˜“æ¨ªãƒãƒ¼)è¿½åŠ ã€‚
  5. logicInputs persistence v2 migrationã€‚
  6. EffectsBus (ä»®: ãƒãƒ¼ãƒ‰ãƒ‘ã‚¹ passthrough â†’ å¾Œã§FXãƒã‚§ãƒ¼ãƒ³æŒ¿å…¥)ã€‚
- ãƒªã‚¹ã‚¯ã¨å¯¾ç­–:
  - äºŒé‡ç”Ÿæˆ: ensureTrack ã§æ—¢å­˜ trackId ãƒã‚§ãƒƒã‚¯ã€‚
  - ç ´æ£„æ¼ã‚Œ: disposeTrack(trackId) ã§ AudioNode.disconnect + é…åˆ—é™¤å» + eventsã€‚
  - Migrationå¤±æ•—: versionã‚¿ã‚°å¿…é ˆ + try/catch ãƒ­ã‚°ã€‚
- æˆåŠŸæ¡ä»¶(çµ±åˆãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†):
  - LogicInput ã® enable/assign æ“ä½œã ã‘ã§ TrackList ã«å‡ºç¾/æ¶ˆæ»…ã€‚
  - Track mute/solo/volume ãŒ LogicInput çµŒç”±ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«çŸ›ç›¾ãªãé©ç”¨ã€‚
  - å†èª­è¾¼å¾Œã‚‚ Track/LogicInput å¯¾å¿œé–¢ä¿‚ãŒå¾©å…ƒã€‚

### 2025-08-11 ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·å¯¾å¿œæ–¹é‡ & ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ç­”åæ˜ 
- æœ¬ç¯€ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ç­”(äº‹å‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å„ªå…ˆ / æœ€å¤§256 Track / ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºä¸å¯ / Controlleræ‹¡å¼µ: MIDI+Gamepad+OSC å¾Œæ®µ / æ—©æœŸProjectStateçµ±åˆ / ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ãƒã‚¤ãƒ‘ã‚¹ / Insert+SendäºŒå±¤å°å…¥ ) ã‚’åæ˜ ã€‚

#### 1. EffectRegistry æ‹¡å¼µ
- Entry è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: `preload():Promise<void>` / `category?` / `latencySec?` / `kind: 'faust-precompiled' | 'faust-compile' | 'native'` (compile ã¯å°†æ¥å®Ÿè£… placeholder)
- Promise ã‚­ãƒ£ãƒƒã‚·ãƒ¥: `registryLoadCache[refId]` ã§å¤šé‡è¦æ±‚æŠ‘æ­¢ã€‚
- ä¸€æ‹¬ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰: `fxAPI.preloadAll(refIds?)` â†’ UI èµ·å‹•æ™‚ or ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã«å…ˆè¡Œã€‚

#### 2. ãƒã‚§ãƒ¼ãƒ³å†æ§‹ç¯‰ (RebuildManager)
- æ“ä½œã‚­ãƒ¥ãƒ¼ `pendingOps` ã« add/remove/move/setBypass ã‚’ push â†’ microtask æœ«å°¾ã§ 1 å› `apply()`ã€‚
- `apply()` æ‰‹é †:
  1. å¤‰æ›´å‰ã® active chain snapshot å–å¾—ã€‚
  2. æ–° chain ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹(ãƒãƒ¼ãƒ‰)æº–å‚™ (ä¸è¶³åˆ† create, å‰Šé™¤å¯¾è±¡ã‚’ retain until fade end)ã€‚
  3. ä¸¦åˆ—ãƒ‘ã‚¹: (oldPathGain=1, newPathGain=0) ã‚’ Master åˆæµç‚¹æ‰‹å‰ã§åˆæˆã€‚
  4. `linearRamp` ã§ crossfade (default 0.02s)ã€‚
  5. ãƒ•ã‚§ãƒ¼ãƒ‰å®Œäº†å¾Œ old ãƒãƒ¼ãƒ‰ç¾¤ disconnect + dispose (bypassä¿æŒãƒãƒ¼ãƒ‰é™¤å¤–)ã€‚
- é€£ç¶šé«˜é€Ÿæ“ä½œ: crossfade ä¸­ã«å†åº¦ç™ºç«ã—ãŸå ´åˆã¯ å‰å› newPath ã‚’ old ã¨ã¿ãªã—å†å…¥ã€‚

#### 3. Bypass å®Ÿè£…
- ãƒãƒ¼ãƒ‰è‡ªä½“ä¿æŒ (CPUè»½å¾®) / å†…éƒ¨ wetGain=0 ã§ãƒŸãƒ¥ãƒ¼ãƒˆã€‚
- Bypass åˆ‡æ›¿æ™‚ã¯ (wet 0â†’1 or 1â†’0) ã‚’ `bypassFadeMs` (default 15ms) ã§å¹³æ»‘ã€‚
- å®Œå…¨é™¤å»å¸Œæœ›æ™‚ã¯ `remove()` API ã‚’ä½¿ç”¨ã€‚

#### 4. Param Scheduler
- API: `setParam(trackId,effectId,paramId,value,{time?,ramp?='linear',smoothMs?})`ã€‚
- `time` æŒ‡å®šãªã—: ç¾åœ¨æ™‚åˆ» + 0.001s (ã‚¬ãƒ¼ãƒ‰) ã§é–‹å§‹ã€‚
- `smoothMs` çœç•¥æ™‚: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 15ms (ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µé–¾å€¤ãªã©çªç™ºå¤‰åŒ–æŠ‘åˆ¶)ã€‚
- ramp ç¨®: 'linear' / 'exp' (exp ã¯çµ‚å€¤>0 ã®å ´åˆã®ã¿) / 'step'ã€‚
- Faustãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: å½“é¢ message (UI thread) é€ä¿¡ + å†…éƒ¨å¹³æ»‘ (å¿…è¦æ™‚) â†’ å°†æ¥ SharedArrayBuffer æ›¸ãè¾¼ã¿ã¸æ‹¡å¼µå¯èƒ½ãªæŠ½è±¡ (`FaustParamAdapter`).

#### 5. Adaptive Scheduling
- `automationTickMs` åˆæœŸ 5msã€‚è² è·è¨ˆæ¸¬ (p95 > 3ms) ã§ 8ms ã¸è‡ªå‹•å¼•ãä¸Šã’ã€‚é€†ã«ä½™è£• (p95 < 1ms) ã§ 3ms ã¸çŸ­ç¸®å¯èƒ½ (ä¸Šé™/ä¸‹é™è¨­å®š)ã€‚
- Metrics: `rebuildDurationMs`, `paramBatchSize`, `schedulerDriftMs` ã‚’ ring buffer ã§ä¿æŒã— `fxAPI.getMetrics()` ã§å–å¾—ã€‚

#### 6. ProjectState v2 çµ±åˆ
- æ—§: `tracksState/v1` + `logicInputs/v3` â†’ æ–°: `projectState/v2` å˜ä¸€ä¿å­˜ã€‚
- ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†:
```json
{
  "version": 2,
  "tracks": [
    { "id":"t1","kind":"faust","name":"Synth1","volume":0.8,"mute":false,"solo":false,
      "effectsChain":[
        { "refId":"revLarge","effectId":"e1","bypass":false,
          "params": { "decay":2.5, "mix":0.35 }, "order":0 }
      ],
      "sends": [ { "busId":"auxVerb","gain":0.5 } ]
    }
  ],
  "auxBuses": [ { "id":"auxVerb","effectsChain":[],"name":"ReverbBus" } ],
  "logicInputs": [ /* æ—¢å­˜ v3 fields + trackId */ ],
  "mappings": [ /* controller mapping (å°†æ¥) */ ],
  "automation": [ /* points (å¾Œæ®µ) */ ]
}
```
- Migration æ‰‹é †:
  1. æ—¢å­˜ keys èª­è¾¼ â†’ Track / LogicInput ãƒãƒ¼ã‚¸ â†’ effectsChain ç©ºé…åˆ—ä»˜ä¸ã€‚
  2. ä¿å­˜æ™‚ã¯æ–°ã‚­ãƒ¼ `projectState/v2` ã¸æ›¸è¾¼ã€‚æ—§ã‚­ãƒ¼ã¯æ®‹ç½® (å¾Œã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—)ã€‚

#### 7. Insert / Send äºŒå±¤
- Track: `insertEffects[]` â†’ outputGain â†’ (sendTapGain[]) â†’ master / aux busesã€‚
- Send: Trackæ¯ `sendGains[busId]` (0..1)ã€‚ProjectState ã« `sends` é…åˆ—ã€‚
- AuxBus: `auxBuses[]` (æ§‹é€ ã¯ Track ã«è¿‘ã„ãŒ master ã¸æœ€çµ‚åˆæµ / ãƒ«ãƒ¼ãƒ—é˜²æ­¢ãƒã‚§ãƒƒã‚¯)ã€‚
- æ—©æœŸã¯ UI æœªæä¾› (å†…éƒ¨çŠ¶æ…‹ã®ã¿)ã€‚

#### 8. å¤§è¦æ¨¡ (æœ€å¤§256 Track) å¯¾ç­–
- Analyser é…å»¶ç”Ÿæˆ + å¯è¦– Track é™å®šæ›´æ–°ã€‚
- `EffectInstance.latencySec?` ã§å°†æ¥è£œæ­£äºˆç´„ (ç¾åœ¨ã¯æœªä½¿ç”¨)ã€‚
- ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰: åˆå›èµ·å‹•æ™‚ã«å¿…é ˆ FX(refId allowlist) ã‚’ parallel fetchã€‚

#### 9. ã‚¨ãƒ©ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- ãƒ­ãƒ¼ãƒ‰å¤±æ•—: placeholder GainNode unity + `effect.meta.error=true`ã€‚
- å†è©¦è¡Œ API: `fxAPI.retryLoad(effectId)`ã€‚

#### 10. å…¬é–‹ API (åˆæœŸ)
```ts
fxAPI = {
  preloadAll, add, remove, move, setBypass, setParam, list, loadPreset,
  getMetrics, saveProject, loadProject
}
```

#### 11. å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—æ›´æ–°
1. EffectRegistry (preload, Promise cache) + Precompiled Faust Loader stub
2. Track model æ‹¡å¼µ: `insertEffects`, `sends`, AuxBus å‹è¿½åŠ 
3. RebuildManager (MVP: crossfade) + fxAPI åŸºæœ¬æ“ä½œ
4. ProjectState v2 migration å®Ÿè£… (æ—§ã‚­ãƒ¼èª­ã¿è¾¼ã¿â†’çµ±åˆä¿å­˜)
5. Param Scheduler + setParam smoothing
6. Bypass crossfade å®Ÿè£… + metrics åé›†
7. Send/Aux å†…éƒ¨é…ç·š (UIç„¡ã—)
8. UI: Trackè¡Œ FXã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ + ç°¡æ˜“ list() è¡¨ç¤º
9. (å¿…è¦æ™‚) MIDI Adapter stub / MappingRegistry ã‚¹ã‚±ãƒ«ãƒˆãƒ³
10. æœ€é©åŒ–: ãƒãƒƒãƒ rebuild / adaptive scheduling

### 2025-08-18 Phase 2: TrackLifecycleManager & éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ä¿®æ­£å®Œäº† âœ…
**æ¦‚è¦**: Trackç”Ÿæˆãƒ»ç ´æ£„ã®å®‰å…¨åŒ–ã€éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å•é¡Œã®è§£æ±ºã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®æ“ä½œæ€§å‘ä¸Šã‚’å®Œäº†ã€‚

#### **Phase 1: éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç·Šæ€¥ä¿®æ­£**
- **å•é¡ŒçŠ¶æ³**: DSPéŸ³å£°ã¯ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ãŒã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰ç„¡éŸ³ã€ãƒ¡ãƒ¼ã‚¿ã‚‚å‹•ä½œã›ãš
- **æ ¹æœ¬åŸå› **: busManager ã« outputGainNode ã¨ effectsInput ãŒå­˜åœ¨ã—ãªã„
- **æŠ€è¡“çš„è§£æ±º**:
  - busManager åˆæœŸåŒ–æ™‚ã« outputGainNode, effectsInput ã‚’è¿½åŠ ç”Ÿæˆ
  - éŸ³å£°ãƒã‚§ãƒ¼ãƒ³ä¿®æ­£: `effectsInput â†’ outputGainNode â†’ destination`
  - ãƒˆãƒ©ãƒƒã‚¯æ¥ç¶šå…ˆã‚’ busManager.effectsInput ã«çµ±ä¸€
- **å‹•ä½œç¢ºèª**: mysynth, testsynth ã‹ã‚‰å®Ÿéš›ã®éŸ³å£°å‡ºåŠ›å¾©æ´»

#### **Phase 2: TrackLifecycleManagerå®Ÿè£…**
- **æ–°ãƒ•ã‚¡ã‚¤ãƒ«**: `src/audio/trackLifecycleManager.ts` (178è¡Œ)
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã€å®‰å…¨ãªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- **ä¸»è¦æ©Ÿèƒ½**:
  - `createTrackSafely()`: 15ms ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ä»˜ãå®‰å…¨Trackç”Ÿæˆ
  - `dismissTrackSafely()`: 20ms ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆå¾Œè‡ªå‹•å‰Šé™¤
  - AudioContext è‡ªå‹•è¨­å®šãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ï¼ˆwindow.audioCtxåˆ©ç”¨ï¼‰
  - çµ±è¨ˆæƒ…å ±å–å¾—ï¼ˆgetStatsï¼‰ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **çµ±åˆ**: audioCore.ensureBaseAudio ã§ã®AudioContextè‡ªå‹•è¨­å®š

#### **Phase 3: EffectRegistryæ“ä½œæ€§å¤§å¹…å‘ä¸Š**
- **ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½æ”¹è‰¯**:
  - é‡è¤‡ã‚¹ã‚­ãƒ£ãƒ³æŠ‘åˆ¶: å…¨ãƒ™ãƒ¼ã‚¹DSPç™»éŒ²æ¸ˆã¿ã®å ´åˆã¯è‡ªå‹•ã‚¹ã‚­ãƒƒãƒ—
  - ã‚ˆã‚Šè©³ç´°ãªãƒ­ã‚°å‡ºåŠ›ã¨ã‚¹ã‚­ãƒƒãƒ—ç†ç”±ã®æ˜ç¢ºåŒ–
  - `force` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¼·åˆ¶å†ã‚¹ã‚­ãƒ£ãƒ³å¯¾å¿œ
- **é–‹ç™ºè€…å‘ã‘APIæ‹¡å¼µ**:
  - `fx` ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ˜ãƒ«ãƒ‘ãƒ¼: scan(), ls(), inst(), reset(), verbose(), ensure()
  - ãƒ‡ãƒãƒƒã‚°ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹: effectRegistryDebug æ‹¡å¼µ
  - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°: resetEffectRegistry(), ensureEffect()
  - å†—é•·ãƒ­ã‚°åˆ¶å¾¡: setEffectRegistryVerbose()

#### **Phase 4: å®Ÿå‹•ä½œãƒ†ã‚¹ãƒˆå®Œäº†**
- **æ¤œè¨¼ã‚·ãƒŠãƒªã‚ª**:
  1. fx.reset() â†’ å…¨ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå‰Šé™¤ï¼ˆãƒã‚¤ãƒ†ã‚£ãƒ–ä¿æŒï¼‰
  2. fx.scan() â†’ DSPãƒ•ã‚¡ã‚¤ãƒ«å†ç™»éŒ²ï¼ˆ3å€‹æ¤œå‡º: mysynth, testsignals, testsynthï¼‰
  3. fx.ls() â†’ ç™»éŒ²æ¸ˆã¿ã‚¨ãƒ•ã‚§ã‚¯ãƒˆä¸€è¦§è¡¨ç¤ºï¼ˆãƒã‚¤ãƒ†ã‚£ãƒ–3 + DSP3 = è¨ˆ6å€‹ï¼‰
  4. fx.inst('testsynth') â†’ Faust AudioWorkletNodeç”ŸæˆæˆåŠŸ
- **çµæœ**: å…¨éŸ³å£°å‡ºåŠ›æ­£å¸¸ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæ“ä½œã‚‚ç°¡æ˜“åŒ–å®Œäº†

#### **æŠ€è¡“çš„æ”¹å–„ç‚¹**
- **è‡ªå‹•AudioContextè¨­å®š**: TrackLifecycleManager ãŒæœªè¨­å®šæ™‚ã« window.audioCtx ã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ¡ç”¨
- **æ¥ç¶šãƒ­ã‚°å¼·åŒ–**: Trackç”Ÿæˆæ™‚ã®æ¥ç¶šå…ˆã‚’ãƒ­ã‚°å‡ºåŠ›ã§å¯è¦–åŒ–
- **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ”¹å–„**: å¤±æ•—æ™‚ã«ã‚ˆã‚Šå…·ä½“çš„ãªåŸå› ã¨å¯¾å‡¦æ–¹æ³•ã‚’è¡¨ç¤º
- **ã‚¹ã‚­ãƒ£ãƒ³ãƒ­ã‚¸ãƒƒã‚¯æœ€é©åŒ–**: æ—¢å­˜ç™»éŒ²çŠ¶æ³ã‚’è€ƒæ…®ã—ãŸç„¡é§„ãªå‡¦ç†å‰Šæ¸›

#### **é–‹ç™ºä½“é¨“å‘ä¸Š**
- **ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼æ“ä½œ**: `fx.inst('testsynth')` ã§å³åº§ã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”Ÿæˆ
- **çŠ¶æ…‹ç¢ºèªç°¡æ˜“åŒ–**: `fx.ls()` ã§ç™»éŒ²çŠ¶æ³ã€`fx.has('id')` ã§å­˜åœ¨ç¢ºèª
- **ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½**: `fx.reset()` ã§é–‹ç™ºæ™‚ã®çŠ¶æ…‹åˆæœŸåŒ–
- **å†—é•·ãƒ­ã‚°åˆ¶å¾¡**: `fx.verbose(false)` ã§æœ¬ç•ªç’°å¢ƒå‘ã‘é™éŸ³åŒ–

#### **æ¬¡æ®µéšæº–å‚™å®Œäº†**
- **Insert FXãƒã‚§ãƒ¼ãƒ³API**: Trackå˜ä½ã§ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆæ©Ÿèƒ½
- **GUIåŒæœŸ**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¡ãƒ¼ã‚¿ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿UIé€£æº
- **æ°¸ç¶šåŒ–**: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒã‚§ãƒ¼ãƒ³çŠ¶æ…‹ã®ä¿å­˜ãƒ»å¾©å…ƒæ©Ÿèƒ½
- **ã‚«ãƒ†ã‚´ãƒªæ‹¡å¼µ**: synths/, effects/ ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³

#### **å“è³ªæŒ‡æ¨™**
- **éŸ³å£°å‡ºåŠ›**: âœ… å…¨DSPéŸ³å£°æ­£å¸¸å‡ºåŠ›
- **æ“ä½œæ€§**: âœ… fx.* APIã«ã‚ˆã‚‹ç›´æ„Ÿçš„æ“ä½œ
- **å®‰å®šæ€§**: âœ… ãƒ•ã‚§ãƒ¼ãƒ‰å‡¦ç†ã«ã‚ˆã‚‹ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ã‚ºé˜²æ­¢
- **é–‹ç™ºåŠ¹ç‡**: âœ… ãƒªã‚»ãƒƒãƒˆãƒ»å†ã‚¹ã‚­ãƒ£ãƒ³ã«ã‚ˆã‚‹é«˜é€Ÿåå¾©é–‹ç™º

## ğŸ¼ **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›®çš„ãƒ»ç¾çŠ¶åˆ†æ** (2025-08-19 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç†è§£ä¿®æ­£)

### ğŸ¯ **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çœŸã®ç›®çš„**
**ç¾ä»£éŸ³æ¥½ãƒ»ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ãƒ»ãƒŸã‚¯ã‚¹ãƒˆéŸ³æ¥½ã®ãŸã‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¼”å¥åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ **

#### **åŸºæœ¬ã‚³ãƒ³ã‚»ãƒ—ãƒˆ**
- **ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹è¨˜è¿°**: éŸ³å£°å‡¦ç†ãƒ»æ˜ åƒç”Ÿæˆã‚’äº‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨˜è¿°
- **æ™‚é–“è»¸åˆ¶å¾¡**: ãƒ†ãƒ³ãƒãƒ»æ‹æ•°ãƒ»å°ç¯€æ•°ã«ã‚ˆã‚‹éŸ³æ¥½çš„æ™‚é–“ç®¡ç†
- **æœ¬ç•ªæ¼”å¥ã‚·ã‚¹ãƒ†ãƒ **: å®Œæˆã—ãŸä½œå“ã®ç¢ºå®Ÿãƒ»å®‰å®šã—ãŸãƒ©ã‚¤ãƒ–å®Ÿè¡Œ
- **ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦**: å¥è€…å‘ã‘ç”»é¢ï¼ˆè¤‡æ•°ï¼‰+ ã‚ªãƒšãƒ¬ãƒ¼ã‚¿åˆ¶å¾¡ç”»é¢
- **å¤–éƒ¨é€£æº**: ç…§æ˜ãƒ»æ˜ åƒãƒ»éŒ²éŸ³ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ

#### **æƒ³å®šã•ã‚Œã‚‹ä½¿ç”¨å ´é¢**
```
ç¾ä»£éŸ³æ¥½ã‚³ãƒ³ã‚µãƒ¼ãƒˆ:
å¥è€… â†’ æ¥½å™¨æ¼”å¥ + ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹åˆ¶å¾¡
â†“
éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ  â†’ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ DSPå‡¦ç† + éŸ³éŸ¿ç©ºé–“åˆ¶å¾¡  
â†“
æ˜ åƒã‚·ã‚¹ãƒ†ãƒ  â†’ éŸ³éŸ¿é€£å‹•ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç”Ÿæˆ
â†“
çµ±åˆåˆ¶å¾¡ â†’ ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã«ã‚ˆã‚‹å…¨ä½“çµ±æ‹¬
```

### ğŸ“Š **éŸ³éŸ¿ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…çŠ¶æ³**

#### âœ… **å®Œå…¨å®Ÿè£…æ¸ˆã¿ï¼ˆéŸ³éŸ¿åŸºç›¤ï¼‰**
1. **Base Audioåˆ†é›¢** - ãƒ†ã‚¹ãƒˆä¿¡å·ãŒDSPé©ç”¨å‰ã‹ã‚‰åˆ©ç”¨å¯èƒ½
2. **Faust WASMçµ±åˆ** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ DSPã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡
3. **TrackLifecycleManager** - 15ms/20msãƒ•ã‚§ãƒ¼ãƒ‰ä»˜ãå®‰å…¨Trackç®¡ç†
4. **EffectRegistry v2** - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ»ã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ¤å®šãƒ»fx APIãƒ˜ãƒ«ãƒ‘ãƒ¼
5. **éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°** - busManager with outputGainNode/effectsInput
6. **æ°¸ç¶šåŒ–v1** - TrackçŠ¶æ…‹(volume/mute/solo/name)ã®localStorageä¿å­˜

#### ğŸš§ **éƒ¨åˆ†å®Ÿè£…æ¸ˆã¿ï¼ˆæ‹¡å¼µå¯èƒ½ï¼‰**
1. **Insert FXãƒã‚§ãƒ¼ãƒ³åŸºç›¤** - Track.insertEffects[]é…åˆ—ãƒ»åŸºæœ¬CRUD APIå®Ÿè£…æ¸ˆã¿
2. **Master FXãƒã‚§ãƒ¼ãƒ³** - ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰å¯¾å¿œãƒ»é…å»¶ã‚­ãƒ¥ãƒ¼æ©Ÿèƒ½
3. **GUIãƒ»ãƒ¡ãƒ¼ã‚¿** - åŸºæœ¬çš„ãªãƒ¬ãƒ™ãƒ«è¡¨ç¤ºãƒ»ã‚«ãƒ†ã‚´ãƒªåˆ¥è‰²åˆ†ã‘
4. **è¨ºæ–­ãƒ»ãƒ‡ãƒãƒƒã‚°** - åŒ…æ‹¬çš„ãªçŠ¶æ…‹è¨ºæ–­ãƒ»ãƒ†ã‚¹ãƒˆé–¢æ•°ç¾¤

#### âŒ **æœªå®Ÿè£…ï¼ˆç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶ï¼‰**
1. **éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡** - ãƒ†ãƒ³ãƒãƒ»æ‹å­ãƒ»å°ç¯€ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°
2. **ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ã‚¹ãƒ†ãƒ ** - å¥è€…ç”»é¢ãƒ»ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ç”»é¢åˆ†é›¢
3. **ã‚¹ã‚³ã‚¢ãƒ»ã‚­ãƒ¥ãƒ¼è¡¨ç¤º** - æ¼”å¥è€…å‘ã‘æ¥½è­œãƒ»æŒ‡ç¤ºè¡¨ç¤º
4. **å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº** - OSCãƒ»MIDIãƒ»HTTPé€šä¿¡ã«ã‚ˆã‚‹çµ±åˆåˆ¶å¾¡
5. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨˜è¿°è¨€èª** - æ™‚é–“è»¸ãƒ»ãƒˆãƒªã‚¬ãƒ¼ãƒ»æ¡ä»¶åˆ†å²è¨˜è¿°ã‚·ã‚¹ãƒ†ãƒ 

### ğŸ¼ **ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**

#### **éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ **
```typescript
// æ™‚é–“è¨˜è¿°ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç¾ä»£éŸ³æ¥½å¯¾å¿œï¼‰
type MusicalTime = 
  | { type: 'absolute', seconds: number }           // çµ¶å¯¾æ™‚é–“: 125.5ç§’
  | { type: 'musical', bars: number, beats: number, subdivisions?: number } // éŸ³æ¥½æ™‚é–“: 32å°ç¯€2æ‹ç›®
  | { type: 'tempo_relative', beats: number }       // ãƒ†ãƒ³ãƒç›¸å¯¾: 64æ‹å¾Œ
  | { type: 'trigger_wait', triggerId: string }     // ãƒˆãƒªã‚¬ãƒ¼å¾…ã¡: "soloist_phrase_end"
  | { type: 'conductor_cue', cueId: string }        // æŒ‡æ®è€…ã‚­ãƒ¥ãƒ¼: "section_B_start"

// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨˜è¿°ä¾‹ï¼ˆã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ãƒ»ãƒŸã‚¯ã‚¹ãƒˆä½œå“ï¼‰
const performance = {
  "title": "Resonance Fields - for violin and electronics",
  "composer": "Contemporary Composer",
  "duration": "12:30",
  "performers": ["violin", "electronics_operator"],
  
  "timeline": [
    {
      "section": "I. Preparation",
      "time": { "type": "absolute", "seconds": 0 },
      "actions": [
        { "type": "start_metronome", "bpm": 60, "subdivision": 4, "performers": ["violin"] },
        { "type": "prepare_electronics", "dsp_chain": ["granular_delay", "spectral_filter"] },
        { "type": "visual_cue", "message": "æº–å‚™å®Œäº†", "target": "performer_1" }
      ]
    },
    {
      "section": "II. Entrance - violin solo",
      "time": { "type": "conductor_cue", "cueId": "violin_entrance" },
      "actions": [
        { "type": "activate_input", "source": "violin_mic", "gain": 0.9 },
        { "type": "apply_dsp", "target": "violin", "effects": ["subtle_reverb"] },
        { "type": "start_visual", "mode": "waveform_analysis" }
      ]
    },
    {
      "section": "III. Electronics entry",
      "time": { "type": "musical", "bars": 8, "beats": 1 },
      "actions": [
        { "type": "fade_in_synth", "dsp": "spectral_synth", "duration": "4_beats" },
        { "type": "crossfade_visual", "from": "waveform", "to": "spectral_cascade" },
        { "type": "send_osc", "address": "/lighting/fade_to_blue", "args": [3.0] }
      ]
    }
  ]
}
```

#### **ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¥è€…ç”»é¢       â”‚    â”‚  æŒ‡æ®è€…ç”»é¢      â”‚    â”‚ ã‚ªãƒšãƒ¬ãƒ¼ã‚¿åˆ¶å¾¡   â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ â™ª 60 BPM (4/4)  â”‚    â”‚ â™« ã‚¹ã‚³ã‚¢è¡¨ç¤º     â”‚    â”‚ ğŸ›ï¸ éŸ³éŸ¿åˆ¶å¾¡      â”‚
â”‚ ğŸ“ 32å°ç¯€1æ‹ç›®   â”‚    â”‚ ğŸ“ é€²è¡ŒçŠ¶æ³     â”‚    â”‚ ğŸ“Š ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿   â”‚
â”‚ ğŸµ "Entrance"   â”‚    â”‚ ğŸ¯ æ¬¡å›ã‚­ãƒ¥ãƒ¼    â”‚    â”‚ ğŸ”— å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ    â”‚
â”‚ ğŸ¤ Input Level  â”‚    â”‚ â±ï¸ ã‚¿ã‚¤ãƒŸãƒ³ã‚°   â”‚    â”‚ ğŸ¬ æ˜ åƒåŒæœŸ      â”‚
â”‚ ğŸ’¡ "cresc."     â”‚    â”‚ ğŸ¼ ãƒ‘ãƒ¼ãƒˆè¡¨ç¤º    â”‚    â”‚ ğŸ“¡ OSC/MIDI     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**
```typescript
interface ContemporaryMusicSystem {
  // ç…§æ˜ã‚·ã‚¹ãƒ†ãƒ é€£æº
  lighting: {
    sendOSC(address: string, args: number[]): void;
    // ä¾‹: /lighting/scene_change "ethereal" 5.0
    syncToAudio(analysisType: 'amplitude' | 'spectral' | 'onset'): void;
  };
  
  // æ˜ åƒã‚·ã‚¹ãƒ†ãƒ é€£æº  
  video: {
    triggerEffect(effectId: string, intensity: number): void;
    syncVisualToScore(barNumber: number, beatPosition: number): void;
    // ä¾‹: ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆã‚’éŸ³éŸ¿è§£æã¨åŒæœŸ
  };
  
  // éŒ²éŸ³ã‚·ã‚¹ãƒ†ãƒ é€£æº
  recording: {
    startMultitrackRecording(tracks: string[]): void;
    addMarker(label: string, timecode: string): void;
    // ä¾‹: æ¥½ç« ã”ã¨ã€é‡è¦ãªã‚­ãƒ¥ãƒ¼ãƒã‚¤ãƒ³ãƒˆã§ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 
  };
  
  // ç©ºé–“éŸ³éŸ¿åˆ¶å¾¡
  spatialAudio: {
    moveSoundSource(sourceId: string, position: [number, number, number]): void;
    controlAmbisonicRotation(azimuth: number, elevation: number): void;
    // ä¾‹: å¥è€…ã®éŸ³åƒã‚’ç©ºé–“å†…ã§ç§»å‹•ã€é›»å­éŸ³ã®3Dé…ç½®
  };
}
```

#### **æ¼”å¥æ”¯æ´æ©Ÿèƒ½**
```typescript
interface PerformerAssistance {
  // ãƒ¡ãƒˆãƒ­ãƒãƒ¼ãƒ ãƒ»ã‚¯ãƒªãƒƒã‚¯
  metronome: {
    setComplexMeter(numerator: number, denominator: number, subdivision?: number): void;
    // ä¾‹: 7/8æ‹å­ã€è¤‡é›‘ãªæ‹å­ã¸ã®å¯¾å¿œ
    enableRitardando(startBar: number, endBar: number, finalTempo: number): void;
    setClickSound(type: 'traditional' | 'subtle' | 'custom', volume: number): void;
  };
  
  // æ¥½è­œãƒ»æŒ‡ç¤ºè¡¨ç¤º
  scoreDisplay: {
    showCurrentMeasure(measureNumber: number): void;
    highlightNextCue(cueType: 'dynamics' | 'technique' | 'electronics'): void;
    displayPerformanceNote(message: string, duration: number): void;
    // ä¾‹: "æ¬¡ï¼šsul ponticello", "ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹é–‹å§‹ã¾ã§4å°ç¯€"
  };
  
  // éŸ³éŸ¿ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  audioFeedback: {
    enableMonitoring(source: 'self' | 'electronics' | 'mix'): void;
    setMonitorLevel(level: number): void;
    provideIntonationReference(pitch: number): void; // A=440Hzç­‰
  };
}
```

### ğŸš€ **å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ å¯¾å¿œï¼‰**

#### **Phase 1: éŸ³æ¥½çš„æ™‚é–“è»¸ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰** (å„ªå…ˆåº¦: æœ€é«˜)
**ç›®æ¨™**: ãƒ†ãƒ³ãƒãƒ»æ‹å­ãƒ»å°ç¯€ãƒ™ãƒ¼ã‚¹ã®æ™‚é–“åˆ¶å¾¡ã‚¨ãƒ³ã‚¸ãƒ³
```typescript
// å®Ÿè£…å¯¾è±¡
- MusicalTimeManager: éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡
- TempoEngine: è¤‡é›‘æ‹å­ãƒ»ãƒ†ãƒ³ãƒå¤‰åŒ–å¯¾å¿œ  
- PerformanceScheduler: ã‚¹ã‚³ã‚¢è¨˜è¿°â†’å®Ÿè¡Œå¤‰æ›
- CueSystem: å¥è€…ãƒ»æŒ‡æ®è€…å‘ã‘ã‚­ãƒ¥ãƒ¼ç®¡ç†
```
**ç¾çŠ¶æ´»ç”¨**: æ—¢å­˜audioCore, busManager, effectRegistryã‚’æ™‚é–“è»¸åˆ¶å¾¡ä¸‹ã«çµ±åˆ
**ä½œæ¥­é‡**: ä¸­ (5-7æ—¥)

#### **Phase 2: ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹UI** (å„ªå…ˆåº¦: é«˜)
**ç›®æ¨™**: å¥è€…å‘ã‘ç”»é¢ãƒ»ã‚ªãƒšãƒ¬ãƒ¼ã‚¿åˆ¶å¾¡ç”»é¢ã®åˆ†é›¢
```typescript
// å®Ÿè£…å¯¾è±¡  
- PerformerWindow: ãƒ¡ãƒˆãƒ­ãƒãƒ¼ãƒ ãƒ»æ¥½è­œãƒ»ã‚­ãƒ¥ãƒ¼è¡¨ç¤º
- OperatorWindow: å…¨ä½“åˆ¶å¾¡ãƒ»ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–
- WindowManager: Tauri ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç®¡ç†
- InterWindowCommunication: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ
```
**ç¾çŠ¶æ´»ç”¨**: controller.tsã‚’OperatorWindowå‘ã‘ã«æ‹¡å¼µã€æ–°è¦PerformerWindowä½œæˆ
**ä½œæ¥­é‡**: ä¸­ (4-6æ—¥)

#### **Phase 3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨˜è¿°è¨€èª** (å„ªå…ˆåº¦: é«˜)
**ç›®æ¨™**: JSON/YAMLå½¢å¼ã§ã®æ¼”å¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨˜è¿°ãƒ»å®Ÿè¡Œ
```typescript
// å®Ÿè£…å¯¾è±¡
- PerformanceScript: æ¼”å¥è¨˜è¿°ãƒ‘ãƒ¼ã‚µãƒ¼
- TimelineExecutor: ã‚¹ã‚¯ãƒªãƒ—ãƒˆâ†’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å®Ÿè¡Œ
- TriggerSystem: æ¡ä»¶åˆ†å²ãƒ»å¾…æ©Ÿåˆ¶å¾¡
- ScriptValidator: äº‹å‰æ¤œè¨¼ãƒ»ã‚¨ãƒ©ãƒ¼æ¤œå‡º
```
**ç¾çŠ¶æ´»ç”¨**: effectRegistry, trackLifecycleManagerã‚’æ™‚é–“è»¸ã§åˆ¶å¾¡
**ä½œæ¥­é‡**: å¤§ (7-10æ—¥)

#### **Phase 4: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ** (å„ªå…ˆåº¦: ä¸­)
**ç›®æ¨™**: OSCãƒ»MIDIãƒ»HTTPé€šä¿¡ã«ã‚ˆã‚‹çµ±åˆåˆ¶å¾¡
```typescript
// å®Ÿè£…å¯¾è±¡
- OSCInterface: Open Sound Control é€å—ä¿¡
- MIDIController: MIDIæ©Ÿå™¨ãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é€£æº
- HTTPGateway: RESTful APIãƒ»WebSocketé€šä¿¡
- ExternalSyncManager: é…å»¶è£œå„Ÿãƒ»åŒæœŸåˆ¶å¾¡
```
**ç¾çŠ¶æ´»ç”¨**: æ—¢å­˜éŸ³éŸ¿ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶å¾¡å¯èƒ½ã«æ‹¡å¼µ
**ä½œæ¥­é‡**: ä¸­ (4-6æ—¥)

#### **Phase 5: æ¼”å¥æ”¯æ´ãƒ»å¯è¦–åŒ–å¼·åŒ–** (å„ªå…ˆåº¦: ä¸­)
**ç›®æ¨™**: æ¥½è­œè¡¨ç¤ºãƒ»éŸ³éŸ¿ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»æ˜ åƒåŒæœŸ
```typescript
// å®Ÿè£…å¯¾è±¡
- ScoreRenderer: æ¥½è­œãƒ»æŒ‡ç¤ºè¡¨ç¤ºã‚¨ãƒ³ã‚¸ãƒ³
- AudioVisualSync: éŸ³éŸ¿è§£æâ†’æ˜ åƒç”Ÿæˆé€£æº
- MonitoringSystem: å¥è€…å‘ã‘éŸ³éŸ¿ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- RecordingIntegration: ãƒãƒ«ãƒãƒˆãƒ©ãƒƒã‚¯éŒ²éŸ³ãƒ»ãƒãƒ¼ã‚«ãƒ¼
```
**ç¾çŠ¶æ´»ç”¨**: visualizers/ ã‚’æ¼”å¥æ”¯æ´å‘ã‘ã«ç‰¹åŒ–æ‹¡å¼µ
**ä½œæ¥­é‡**: å¤§ (8-12æ—¥)

### ğŸ¯ **ç¾åœ¨ã®éŸ³éŸ¿åŸºç›¤ã¨ã®çµ±åˆæ–¹é‡**

#### **ä¿æŒãƒ»æ´»ç”¨ã™ã‚‹å®Ÿè£…** (å¤‰æ›´æœ€å°é™)
- âœ… **Faust WASMçµ±åˆ**: ç¾ä»£éŸ³æ¥½ã®è¤‡é›‘ãªDSPè¦ä»¶ã«æœ€é©
- âœ… **TrackLifecycleManager**: æ¼”å¥ä¸­ã®å‹•çš„Trackåˆ¶å¾¡ã«å¿…é ˆ
- âœ… **EffectRegistry**: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ‡ã‚Šæ›¿ãˆã«æ´»ç”¨
- âœ… **éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: è¤‡æ•°å¥è€…ãƒ»é›»å­éŸ³ã®çµ±åˆãƒŸã‚­ã‚·ãƒ³ã‚°

#### **æ‹¡å¼µãƒ»æ”¹ä¿®ã™ã‚‹å®Ÿè£…**
- ğŸ”„ **æ™‚é–“åˆ¶å¾¡**: çµ¶å¯¾æ™‚é–“â†’éŸ³æ¥½çš„æ™‚é–“è»¸ã¸ã®æ‹¡å¼µ
- ğŸ”„ **UIåˆ†é›¢**: å˜ä¸€ç”»é¢â†’ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ¼”å¥ç’°å¢ƒ
- ğŸ”„ **åˆ¶å¾¡API**: æ‰‹å‹•æ“ä½œâ†’ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªå‹•å®Ÿè¡Œã¸ã®æ‹¡å¼µ

#### **æ–°è¦å®Ÿè£…ãŒå¿…è¦ãªé ˜åŸŸ**
- ğŸ†• **MusicalTimeManager**: éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡ã‚¨ãƒ³ã‚¸ãƒ³
- ğŸ†• **PerformanceScript**: æ¼”å¥è¨˜è¿°ãƒ»å®Ÿè¡Œã‚·ã‚¹ãƒ†ãƒ 
- ğŸ†• **ExternalSync**: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- ğŸ†• **PerformerUI**: å¥è€…å‘ã‘å°‚ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### ğŸ’¡ **ç¾ä»£éŸ³æ¥½ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã®ç‰¹å¾´**

#### **æŠ€è¡“çš„å¼·ã¿**
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ DSP**: Faust WASMã«ã‚ˆã‚‹é«˜å“è³ªéŸ³éŸ¿å‡¦ç†
- **æŸ”è»Ÿãªæ™‚é–“åˆ¶å¾¡**: è¤‡é›‘æ‹å­ãƒ»ãƒ†ãƒ³ãƒå¤‰åŒ–ãƒ»ä¸è¦å‰‡æ§‹é€ å¯¾å¿œ
- **çµ±åˆåˆ¶å¾¡**: éŸ³éŸ¿ãƒ»æ˜ åƒãƒ»ç…§æ˜ã®ä¸€å…ƒç®¡ç†
- **æ¼”å¥æ”¯æ´**: å¥è€…ã®è² æ‹…è»½æ¸›ãƒ»æ­£ç¢ºãªæ¼”å¥å®Ÿç¾

#### **æƒ³å®šã•ã‚Œã‚‹ä½œå“ä¾‹**
```
1. "Interactive Soundscape" - å¥è€…ã®æ¼”å¥ã«å¿œç­”ã™ã‚‹é›»å­éŸ³éŸ¿
2. "Temporal Layers" - è¤‡æ•°æ™‚é–“è»¸ãŒé‡å±¤ã™ã‚‹ä½œå“
3. "Spatial Electronics" - 3DéŸ³éŸ¿ç©ºé–“ã§ã®éŸ³åƒç§»å‹•
4. "Multimedia Performance" - éŸ³éŸ¿ãƒ»æ˜ åƒãƒ»ç…§æ˜ã®çµ±åˆèŠ¸è¡“
```

ç¾åœ¨ã®å®Ÿè£…åŸºç›¤ã¯**ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦éå¸¸ã«é©ã—ã¦ã„ã‚‹**çŠ¶æ…‹ã§ã™ã€‚éŸ³éŸ¿ã‚¨ãƒ³ã‚¸ãƒ³ã®å“è³ªãŒé«˜ãã€æ™‚é–“è»¸åˆ¶å¾¡ã¨ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å¯¾å¿œã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€**ãƒ—ãƒ­ãƒ¬ãƒ™ãƒ«ã®ç¾ä»£éŸ³æ¥½æ¼”å¥ç’°å¢ƒ**ãŒå®Ÿç¾ã§ãã¾ã™ã€‚

## ä»Šå¾Œã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### **ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€²åŒ–**

ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯**éŸ³éŸ¿å‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã—ã¦é«˜å“è³ªã§å®‰å®š**ã—ã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚ã“ã‚Œã‚’åŸºç›¤ã¨ã—ã¦ã€**ç¾ä»£éŸ³æ¥½ãƒ»ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ãƒ»ãƒŸã‚¯ã‚¹ãƒˆéŸ³æ¥½ã®ãŸã‚ã®æ¼”å¥åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ **ã¸ã¨ç™ºå±•ã•ã›ã‚‹æ®µéšã«å…¥ã‚Šã¾ã—ãŸã€‚

### **ä¿æŒã™ã¹ãæ—¢å­˜å®Ÿè£…**
- âœ… **Faust WASMçµ±åˆ**: ç¾ä»£éŸ³æ¥½ã®è¤‡é›‘ãªDSPè¦ä»¶ã«æœ€é©
- âœ… **TrackLifecycleManager**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³æºåˆ¶å¾¡ã«å¿…é ˆ  
- âœ… **EffectRegistry**: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ãƒ©ã‚¤ãƒ–åˆ‡ã‚Šæ›¿ãˆã«æ´»ç”¨
- âœ… **éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: è¤‡æ•°å¥è€…ãƒ»é›»å­éŸ³ã®çµ±åˆã«æœ€é©
- âœ… **Insert FXãƒã‚§ãƒ¼ãƒ³åŸºç›¤**: æ¼”å¥ä¸­ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆåˆ¶å¾¡ã«æ´»ç”¨

### **æ–°è¦å®Ÿè£…ãŒå¿…è¦ãªæ ¸å¿ƒæ©Ÿèƒ½**

#### **1. éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ** (æœ€å„ªå…ˆ)
- MusicalTimeManager: ãƒ†ãƒ³ãƒãƒ»æ‹å­ãƒ»å°ç¯€ãƒ™ãƒ¼ã‚¹æ™‚é–“åˆ¶å¾¡
- PerformanceScheduler: æ¥½è­œè¨˜è¿°â†’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å®Ÿè¡Œ
- CueSystem: å¥è€…ãƒ»æŒ‡æ®è€…å‘ã‘ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°

#### **2. ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ¼”å¥ç’°å¢ƒ** (é«˜å„ªå…ˆ)
- PerformerWindow: å¥è€…å‘ã‘ãƒ¡ãƒˆãƒ­ãƒãƒ¼ãƒ ãƒ»æ¥½è­œãƒ»æŒ‡ç¤ºè¡¨ç¤º
- OperatorWindow: ã‚ªãƒšãƒ¬ãƒ¼ã‚¿åˆ¶å¾¡ãƒ»ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–
- WindowSyncManager: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ»é€šä¿¡

#### **3. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ** (ä¸­å„ªå…ˆ)  
- OSC/MIDI/HTTPé€šä¿¡ã«ã‚ˆã‚‹ç…§æ˜ãƒ»æ˜ åƒãƒ»éŒ²éŸ³ã‚·ã‚¹ãƒ†ãƒ é€£æº
- ç©ºé–“éŸ³éŸ¿åˆ¶å¾¡ãƒ»ã‚¢ãƒ³ãƒ“ã‚½ãƒ‹ãƒƒã‚¯å¯¾å¿œ
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶è£œå„Ÿãƒ»åŒæœŸåˆ¶å¾¡

### **æ®µéšçš„å®Ÿè£…æ–¹é‡**
1. **Phase 1**: éŸ³æ¥½çš„æ™‚é–“è»¸ â†’ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®æ™‚é–“åˆ¶å¾¡åŒ–
2. **Phase 2**: ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ â†’ Tauriç’°å¢ƒæ´»ç”¨
3. **Phase 3**: æ¼”å¥è¨˜è¿°è¨€èª â†’ JSON/YAML ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
4. **Phase 4**: å¤–éƒ¨é€£æº â†’ çµ±åˆæ¼”å¥ç’°å¢ƒå®Œæˆ
5. **Phase 5**: æ¼”å¥æ”¯æ´å¼·åŒ– â†’ æ¥½è­œè¡¨ç¤ºãƒ»éŒ²éŸ³çµ±åˆ

ç¾åœ¨ã®å®Ÿè£…åŸºç›¤ã«ã‚ˆã‚Šã€**ãƒ—ãƒ­ãƒ¬ãƒ™ãƒ«ã®ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ **ã®å®Ÿç¾ã¯ååˆ†ã«ç¾å®Ÿçš„ã§ã™ã€‚

## â° **é–‹ç™ºæœŸé–“äºˆæ¸¬** (2025-08-19 ç®—å‡º)

### **ç¾çŠ¶åŸºç›¤**: 1é€±é–“å®Œäº† âœ…
- é«˜å“è³ªéŸ³éŸ¿ã‚¨ãƒ³ã‚¸ãƒ³ãƒ»Faust WASMçµ±åˆãƒ»Trackç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- **å·¥æ•°**: ç´„40-50æ™‚é–“ã®é›†ä¸­å®Ÿè£…

### **ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µ**: 10-12é€±é–“äºˆæ¸¬

#### **Phase 1: éŸ³æ¥½çš„æ™‚é–“è»¸ã‚·ã‚¹ãƒ†ãƒ ** (2-3é€±é–“)
- MusicalTimeManagerãƒ»TempoEngineãƒ»PerformanceSchedulerãƒ»CueSystem
- è¤‡é›‘æ‹å­ãƒ»ãƒ†ãƒ³ãƒå¤‰åŒ–ãƒ»æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- **å·¥æ•°**: 60-80æ™‚é–“

#### **Phase 2: ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ¼”å¥ç’°å¢ƒ** (1.5-2é€±é–“)  
- PerformerWindowãƒ»OperatorWindowãƒ»Tauri ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ»ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–“é€šä¿¡
- **å·¥æ•°**: 40-60æ™‚é–“

#### **Phase 3: æ¼”å¥è¨˜è¿°è¨€èªãƒ»å®Ÿè¡Œ** (2-2.5é€±é–“)
- PerformanceScriptãƒ»TimelineExecutorãƒ»TriggerSystem
- JSON/YAML ãƒ‘ãƒ¼ã‚µãƒ¼ãƒ»æ¡ä»¶åˆ†å²ãƒ»æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- **å·¥æ•°**: 60-80æ™‚é–“

#### **Phase 4: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ** (1-1.5é€±é–“)
- OSCãƒ»MIDIãƒ»HTTPé€šä¿¡ãƒ»é…å»¶è£œå„Ÿãƒ»åŒæœŸåˆ¶å¾¡
- ç…§æ˜ãƒ»æ˜ åƒãƒ»éŒ²éŸ³ã‚·ã‚¹ãƒ†ãƒ é€£æº
- **å·¥æ•°**: 30-45æ™‚é–“

#### **Phase 5: æ¼”å¥æ”¯æ´ãƒ»æœ€çµ‚èª¿æ•´** (1-1.5é€±é–“)
- æ¥½è­œè¡¨ç¤ºãƒ»éŸ³éŸ¿ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»å…¨ä½“æœ€é©åŒ–
- **å·¥æ•°**: 30-45æ™‚é–“

### **ç·æœŸé–“**: **ã‚³ã‚¢æ©Ÿèƒ½ 9-12é€±é–“ + æ‹¡å¼µãƒãƒƒãƒ•ã‚¡ 2-4é€±é–“**

### **å°†æ¥æ‹¡å¼µäºˆæ¸¬**
- **çŸ­æœŸ** (+2-4é€±é–“): é«˜åº¦æ¥½è­œè¡¨ç¤ºãƒ»ç©ºé–“éŸ³éŸ¿ãƒ»AIæ”¯æ´
- **ä¸­æœŸ** (+4-8é€±é–“): VR/ARçµ±åˆãƒ»æ©Ÿæ¢°å­¦ç¿’ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¼”å¥  
- **é•·æœŸ** (+8-16é€±é–“): è¤‡æ•°ä¼šå ´åŒæ™‚ãƒ»AIæ¥½è­œç”Ÿæˆãƒ»è´è¡†å‚åŠ 

**æ ¹æ‹ **: ç¾åœ¨ã®é–‹ç™ºé€Ÿåº¦(1æ—¥7-8æ™‚é–“é«˜åŠ¹ç‡)ãƒ»éŸ³éŸ¿åŸºç›¤90%å®Œæˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å„ªç§€ã«ã‚ˆã‚Šä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼å®Ÿè£…ã«é›†ä¸­å¯èƒ½

---

## ğŸ“– **æ–°ãƒãƒ£ãƒƒãƒˆç§»è¡Œæ™‚ã®å‚ç…§æŒ‡é‡**

### **ğŸ“‹ å¿…èª­ã‚»ã‚¯ã‚·ãƒ§ãƒ³**
1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›®çš„**: ç¾ä»£éŸ³æ¥½ãƒ»ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ãƒ»ãƒŸã‚¯ã‚¹ãƒˆéŸ³æ¥½æ¼”å¥åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ 
2. **éŸ³éŸ¿ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…çŠ¶æ³**: å®Œå…¨å®Ÿè£…æ¸ˆã¿ãƒ»éƒ¨åˆ†å®Ÿè£…æ¸ˆã¿ãƒ»æœªå®Ÿè£…ã®è©³ç´°
3. **ç¾ä»£éŸ³æ¥½æ¼”å¥ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**: æ™‚é–“è»¸åˆ¶å¾¡ãƒ»ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»å¤–éƒ¨é€£æºä»•æ§˜
4. **å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—**: Phase 1-5ã®è©³ç´°ãƒ»æ—¢å­˜åŸºç›¤æ´»ç”¨æ–¹é‡
5. **é–‹ç™ºæœŸé–“äºˆæ¸¬**: 10-12é€±é–“ã‚³ã‚¢å®Ÿè£…ãƒ»æ‹¡å¼µäºˆæ¸¬

### **ğŸ”§ æŠ€è¡“åŸºç›¤ç¢ºèªé …ç›®**
- **å®Œå…¨å®Ÿè£…**: Faust WASMãƒ»TrackLifecycleManagerãƒ»EffectRegistryãƒ»éŸ³å£°ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **æ´»ç”¨å¯èƒ½**: tracks.ts Insert FX APIãƒ»busManagerãƒ»audioCoreãƒ»æ°¸ç¶šåŒ–v1
- **fx APIãƒ˜ãƒ«ãƒ‘ãƒ¼**: `fx.scan()`, `fx.inst()`, `fx.ls()`, `fx.reset()`

### **ğŸ¯ æ¬¡ã®å®Ÿè£…å„ªå…ˆé †ä½**
1. **MusicalTimeManager**: éŸ³æ¥½çš„æ™‚é–“è»¸åˆ¶å¾¡ã‚¨ãƒ³ã‚¸ãƒ³ (æœ€å„ªå…ˆ)
2. **ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦**: Tauriç’°å¢ƒã§ã®Performer/Operatorç”»é¢åˆ†é›¢
3. **PerformanceScript**: æ¼”å¥è¨˜è¿°â†’å®Ÿè¡Œå¤‰æ›ã‚·ã‚¹ãƒ†ãƒ 

### **ğŸ’¡ é‡è¦ãªè¨­è¨ˆæ–¹é‡**
- æ—¢å­˜éŸ³éŸ¿åŸºç›¤ã¯é«˜å“è³ªã§å¤‰æ›´æœ€å°é™
- æ™‚é–“åˆ¶å¾¡ã¯çµ¶å¯¾æ™‚é–“â†’éŸ³æ¥½çš„æ™‚é–“è»¸ã¸ã®æ‹¡å¼µ
- UI ã¯å˜ä¸€ç”»é¢â†’ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ¼”å¥ç’°å¢ƒã¸
- åˆ¶å¾¡ã¯æ‰‹å‹•æ“ä½œâ†’ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªå‹•å®Ÿè¡Œã¸ã®æ‹¡å¼µ
